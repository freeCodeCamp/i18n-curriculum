---
id: 6732c05595ca7d422b9e55ff
title: 什么是 `For...in` 循环，什么时候应该使用它？
challengeType: 19
dashedName: what-is-the-for-in-loop-and-when-should-you-use-it
---

# --interactive--

当你需要循环遍历一个对象的属性时，`for...in` 循环是最佳选择。该循环将迭代对象的所有可枚举属性，包括继承的属性和非数字属性。

继承属性是从对象的原型链继承的属性。非数字属性是指不是数字或不能转换为数字的字串的属性。

这是 `for...in` 循环的基本语法：

```js
for (variable in object) {
  // code block to be executed
}
```

示例中的变量表现正在被循环的对象的当前属性。

让我们来看几个例子，这样你可以更好地理解 `for...in` 循环的工作原理。

在这个第一个例子中，我们有一个 `fruit` 对象，想要循环遍历每个属性并将值记录到控制台。

:::interactive_editor

```js
const fruit = {
  name: 'apple',
  color: 'red',
  price: 0.99
};

for (const prop in fruit) {
  console.log(fruit[prop]);
}
```

:::

`prop` 变量表现对象的当前属性。`fruit[prop]` 用于访问每个属性的值。

在第一次迭代中，`prop` 将是 `name`。在第二次迭代中，`prop` 将是 `color`，依此类推。

记录到控制台的结果将是 `apple`、`red` 和 `0.99`。

在这个第二个例子中，我们有一个嵌套对象，我们想要循环遍历每个属性并将值记录到控制台。

:::interactive_editor

```js
const person = {
  name: 'John',
  age: 30,
  address: {
    street: '123 Main St',
    city: 'Anytown',
    state: 'CA'
  }
};

for (const prop in person) {
  console.log(person[prop]);
}
```

:::

`address` 属性本身就是一个对象。`for...in` 循环也会遍历 `person` 对象的属性，并将整个 `address` 对象记录到控制台。

以下是在控制台中显示的结果：

```md
John
30
{ street: '123 Main St', city: 'Anytown', state: 'CA' }
```

如果你想遍历 `address` 对象的属性，可以在第一个 `for...in` 循环内嵌套另一个 `for...in` 循环。

:::interactive_editor

```js
const person = {
  name: 'John',
  age: 30,
  address: {
    street: '123 Main St',
    city: 'Anytown',
    state: 'CA'
  }
};

function isObject(obj) {
  return typeof obj === 'object' && !Array.isArray(obj) && obj !== null;
}

for (const prop in person) {
  if (isObject(person[prop])) {
    for (const nestedProp in person[prop]) {
      console.log(person[prop][nestedProp]);
    }
  } else {
    console.log(person[prop]);
  }
}
```

:::

在此示例中，我们有一个自定义函数 `isObject`，用于查看值是否为对象。

`Array.isArray` 方法用于查看值是否为数组。通过在该方法前放置逻辑非操作符（`!`），我们是在查看该值是否不是数组。

我们不能仅仅使用 `typeof` 等于 `'object'` 的原因是因为数组在 JavaScript 中也被视为对象。我们想要从检查中排除数组。

此外，由于 JavaScript 中的一个历史错误，`typeof null` 返回 `'object'`。所以我们还想从检查中排除 `null` 值。

如果条件为真，我们将嵌套另一个 `for...in` 循环，该循环将遍历嵌套对象的属性并将值记录到控制台。

`nestedProp` 变量表现嵌套对象的当前属性。

下面是在控制台中修改后的结果显示效果：

```md
"John"
30
"123 Main St"
"Anytown"
"CA"
```

当你需要循环遍历一个对象的属性时，`for...in` 循环非常有用。

不建议使用 `for...in` 循环来遍历数组的元素。相反，使用 `for...of` 循环或其他数组方法，如 `forEach`、`map`、`filter` 和 `reduce`，你将在后续课程中学习这些方法。

# --questions--

## --text--

下面代码的输出是什么？

```js
const fruit = {
  name: 'apple',
  color: 'red',
  price: 0.99
};

for (const prop in fruit) {
  console.log(fruit[prop]);
}
```

## --answers--

```md
apple
apple
apple
```

### --feedback--

回顾课程开头以了解 `for...in` 循环的作用。

---

```md
name
color
price
```

### --feedback--

回顾课程开头以了解 `for...in` 循环的作用。

---

```md
apple
red
0.99
```

---

```md
fruit
fruit
fruit
```

### --feedback--

回顾课程开头以了解 `for...in` 循环的作用。

## --video-solution--

3

## --text--

为什么通常不建议使用 `for...in` 循环来迭代数组的元素？

## --answers--

`for...in` 只迭代数组方法，不迭代元素。

### --feedback--

考虑 `for...in` 可以访问的属性和索引的类型。

---

`for...in` 迭代所有可枚举属性，包括继承属性和非数字属性，这可能导致意外结果。

---

`for...in` 循环相比其他数组迭代方法更慢。

### --feedback--

考虑 `for...in` 可以访问的属性和索引的类型。

---

`for...in` 无法处理带有非数字索引的数组。

### --feedback--

考虑 `for...in` 可以访问的属性和索引的类型。

## --video-solution--

2

## --text--

为什么在嵌套循环示例中需要 `isObject` 函数？

## --answers--

查看值是否为字串。

### --feedback--

考虑需要的额外检查以查看值是否为对象字面。

---

确保该值既不是数组也不是 `null`。

---

验证该值是否为整数。

### --feedback--

考虑需要的额外检查以查看值是否为对象字面。

---

将值转换为对象。

### --feedback--

考虑需要的额外检查以查看值是否为对象字面。

## --video-solution--

2
