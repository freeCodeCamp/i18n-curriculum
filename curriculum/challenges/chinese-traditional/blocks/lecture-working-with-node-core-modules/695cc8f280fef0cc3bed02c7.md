---
id: 695cc8f280fef0cc3bed02c7
title: 什麼是 Buffer 模組以及它如何運作？
challengeType: 19
dashedName: what-is-the-buffer-module-and-how-does-it-work
---

# --description--

JavaScript 最初是為了在網頁瀏覽器中執行而創建的，其主要角色是使網頁具有互動性。正因如此，早期的 JavaScript 主要專注於處理表單中的文字以及操作文件物件模型（DOM）。

然而，網路上的資料並非全部都是文字。檔案、影像和影片是二進位資料，這些資料需要不同的處理機制。在瀏覽器中，這些類型的資料通常由瀏覽器的專門組件處理，而非由 JavaScript 本身處理。

現代瀏覽器使用算繪引擎和 JavaScript 引擎來管理這些任務——例如，Chrome 中的 Blink（搭配 V8）、Safari 中的 WebKit（搭配 JavaScriptCore）以及 Firefox 中的 Gecko（搭配 SpiderMonkey）。

Node.js 不會在瀏覽器中執行，所以它需要自己的方式來控制二進位資料，特別是在處理檔案輸入和輸出（I/O）以及 TCP 資料流時，資料是以區塊形式傳入。這就是 `Buffer` 模組的用途。

Node.js 的 `Buffer` 模組讓你可以直接處理像檔案、影像或網路資料流等二進位資料。使用它，你可以直接在記憶體中儲存和操作二進位資料。

就像 `fs` 模組一樣，`Buffer` 是 Node.js 的核心模組之一，因此你不需要在使用前另外安裝它。

要使用它，請先透過解構方式匯入該模組：

```js
const { Buffer } = require("buffer");
```

然後使用它所提供的行為呼叫 `Buffer`。例如，`Buffer.from()` 讓你能從字串、陣列或其他未經處理的資料創建緩衝區。

以下是如何從字串和陣列創建 `Buffer`：

```js
// Create a buffer from a string
const myStrBuffer = Buffer.from("freeCodeCamp");
console.log(myStrBuffer); // <Buffer 66 72 65 65 43 6f 64 65 43 61 6d 70>

// Create a buffer from an array of numbers
const myNumBuffer = Buffer.from([
  70, 82, 69, 69, 67, 79, 68, 69, 67, 65, 77, 80,
]);

console.log(myNumBuffer); // <Buffer 46 52 45 45 43 4f 44 45 43 41 4d 50>
```

雖然可以在未先匯入 `Buffer` 模組的情況下使用部分方法，但其他方法除非你明確匯入 `Buffer`，否則無法使用。因此，建議你在專案中使用 `Buffer` 時，務必始終匯入它。

你可以像存取陣列一樣存取單一的 `buffer` 元素：

```js
console.log(myNumBuffer[0]); // 70
console.log(myStrBuffer[0]); // 102
```

你也可以對緩衝區使用 `toString()` 方法來查看它們的真實樣貌：

```js
console.log(myStrBuffer.toString()); // freeCodeCamp
console.log(myNumBuffer.toString()); // FREECODECAMP
```

`Buffer.alloc()` 讓你創建一個指定大小（位元組數）的新緩衝區。裡面的每個位元組都會自動填充為 `0`：

```js
const someBuffer = Buffer.alloc(10);
console.log(someBuffer); // <Buffer 00 00 00 00 00 00 00 00 00 00>
```

你可以看到緩衝區是根據傳入 `alloc()` 方法的大小以零初始化的。

你可以直接使用 `Buffer.write()` 方法將資料寫入此緩衝區：

```js
someBuffer.write("Hello fCC");

console.log(someBuffer); // <Buffer 48 65 6c 6c 6f 20 66 43 43 00>
console.log(someBuffer.toString()); // Hello fCC
```

如果你寫入的資料超過緩衝區可容納的量，將會被截斷：

```js
someBuffer.write("Hello freeCodeCamp");

console.log(someBuffer); // <Buffer 48 65 6c 6c 6f 20 66 72 65 65>
console.log(someBuffer.toString()); // Hello free
```

最後，你可以使用 `Buffer.byteLength()` 來顯示以某種編碼儲存字串所需的位元組數：

```js
console.log(Buffer.byteLength("Hello freeCodeCamp")); // 18
```

其他 `Buffer` 方法包括：

- `Buffer.isBuffer()`：檢查給定的物件是否為緩衝區
- `Buffer.compare()`：比較兩個緩衝區並傳回它們的排序順序
- `Buffer.concat()`：將多個 buffer 串接成一個。

# --questions--

## --text--

以下哪一項**不是** Node.js `Buffer` 方法？

## --answers--

`Buffer.from()`

### --feedback--

想想 Node.js 如何在瀏覽器外控制二進位資料。

---

`Buffer.alloc()`

### --feedback--

想想 Node.js 如何在瀏覽器外控制二進位資料。

---

`Buffer.concat()`

### --feedback--

想想 Node.js 如何在瀏覽器外控制二進位資料。

---

`Buffer.insert()`

## --video-solution--

4

## --text--

為什麼 Node.js 提供 `Buffer` 模組？

## --answers--

為了提升瀏覽器中 JavaScript 的效率。

### --feedback--

思考 Node.js 如何處理不只是文字的資料。

---

使用基於二進位的 `CSS` 來設計網頁樣式。

### --feedback--

思考 Node.js 如何處理不只是文字的資料。

---

要處理像檔案、影像和 TCP 資料流這類的二進位資料。

---

將 JavaScript 程式碼轉換成機器碼。

### --feedback--

想想 Node.js 如何在瀏覽器外控制二進位資料。

## --video-solution--

3

## --text--

如果你寫入的資料超過緩衝區能容納的容量，會發生什麼情況？

## --answers--

緩衝區會自動調整大小以容納所有資料。

### --feedback--

想想在其中一個範例中，`"Hello freeCodeCamp"` 如何變成 `"Hello free"`。

---

額外的資料被截斷，僅儲存符合容量的部分。

---

Node.js 發出錯誤並停止執行。

### --feedback--

想想在其中一個範例中，`"Hello freeCodeCamp"` 如何變成 `"Hello free"`。

---

緩衝區會覆寫鄰近記憶體位置的資料。

### --feedback--

想想在其中一個範例中，`"Hello freeCodeCamp"` 如何變成 `"Hello free"`。

## --video-solution--

2

