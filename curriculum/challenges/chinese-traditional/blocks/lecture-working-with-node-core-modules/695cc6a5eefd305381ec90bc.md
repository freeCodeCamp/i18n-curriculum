---
id: 695cc6a5eefd305381ec90bc
title: 什麼是 `fs` 模組以及它如何運作？
challengeType: 19
dashedName: what-is-the-fs-module-and-how-does-it-work
---

# --description--

許多語言和框架都提供處理檔案和資料夾的方法。Node.js 讓你可以使用 `fs` 或檔案系統模組來完成這項工作。

本課程將專注於 Node 的 `fs` 模組、它的運作方式，以及你可以使用它所提供的方法的三種不同方式。

Node 的 `fs` 模組為你提供了用於處理檔案和資料夾的行為，包括開啟和關閉、讀取和寫入，以及刪除操作。

`fs` 模組是 Node.js 的標準模組，因此只要你的環境中安裝了 Node.js 就可以使用。要使用該模組，你可以這樣匯入：

```js
const fs = require("fs");
```

`fs` 模組提供的彈性在於它允許你同步和非同步地使用其方法。`fs` 模組的方法預設是非同步的，但每個方法都有同步的表單：

```js
fs.writeFile() // Asynchronous file writing
fs.writeFileSync() // Synchronous file writing

fs.readFile() // Asynchronous file reading
fs.readFileSync() // Synchronous file reading

fs.open() // Opens a file
fs.openAsBlob() // Opens as blob
fs.openSync() // Synchronous open
fs.opendir() // Opens directory
fs.opendirSync() // Synchronous directory open
```

這還不是結束。根據你的需求，你可以用三種方式使用這些方法：

- 使用回呼，例如 `fs.writeFile()`（非同步）
- 如果你偏好 `async/await` 語法，例如 `fs.promises.writeFile()`，可以使用 promises。
- 同步地，例如，`fs.writeFileSync()`

以下是這些方法非同步使用的基本語法：

```js
fs.writeFile("filePath", "content", "utf8", (err) => {
  if (err) {
    throw err;
  }
  console.log("File written to!");
});
```

對於 promises 版本，你可以從 `fs/promises` 匯入，或將 `promises` 串鏈到你的 `fs` 匯入。語法如下：

```js
async function promisesExample() {
  try {
    await fs.promises.writeFile("filePath", "content", "utf8");
    console.log("File written to!");
  } catch (err) {
    console.error("Error:", err);
  }
}

promisesExample();
```

以下是同步版本：

```js
try {
  fs.writeFileSync("filePath", "content", "utf8");
  console.log("File written to!");
} catch (err) {
  console.error("Error:", err);
}
```

請注意，同步使用任何方法都是阻塞的。換句話說，你的程式會停止執行並等待該操作完成，然後才會繼續執行下一行程式碼。

對於快速腳本、小型專案或一次性任務，同步方法可能沒問題。但在實際應用中，阻塞式 I/O（輸入/輸出）會成為問題，因為當 Node 等待檔案系統完成其操作時，可能會凍結應用程式的其他部分。這會降低速度並影響效率和使用者體驗。

這就是非同步方法存在的原因。它們讓你的程式在 Node 在背景處理檔案操作時，能繼續執行其他部分。傳統上，這使用回呼，但隨著你的應用程式成長，回呼很快就會變得混亂。

Promises 和 `async/await` 解決了這個問題。它們仍然是非區塊性的，但程式碼讀起來像一般同步程式碼，且更容易維護。 

因此，基於 promises 的方法通常是今天較受歡迎的做法，而這也是我們在本課程剩餘部分將使用的方法。

`writeFile()` 方法讓你寫入現有的檔案。如果檔案不存在，它會在目前目錄中創建該檔案，然後寫入指定的內容。

以下是如何使用 `writeFile()` 方法：

```js
const fs = require("fs/promises");

async function writeToFile() {
  try {
    await fs.writeFile(
      "article.md",
      "## Node `fs` Module: The Complete Guide",
      "utf8",
    );
    console.log("File written to!");
  } catch (err) {
    console.error("Error writing to file:", err);
  }
}

writeToFile(); // File written to!
```

以下是 article.md 檔案的內容：

```md
## Node `fs` Module: The Complete Guide
```

`appendFile()` 方法讓你將內容添加到現有的檔案。以下是使用方式：

```js
const fs = require("fs/promises");

async function appendToFile() {
  try {
    await fs.appendFile(
      "article.md",
      "\nIn this article, you will learn all there is to know about the Node fs module...",
      "utf8",
    );
    console.log("File appended to!");
  } catch (err) {
    console.log("Error appending to file:", err);
  }
}

appendToFile(); // File appended to!
```

`readFile()` 方法讓你看到檔案的內容：

```js
const fs = require("fs/promises");

async function readFileContent() {
  try {
    const fileContent = await fs.readFile("article.md", "utf8");
    console.log("File content:", fileContent);
  } catch (err) {
    console.log("File read successfully");
  }
}

readFileContent();

/*
File content: ## Node `fs` Module: The Complete Guide

In this article, you will learn all there is to know about the Node fs module...
*/
```

如果你沒有指定 `utf8` 字元編碼，你將會取得該檔案的內容作為緩衝區：

```js
async function readFileContent() {
  try {
    const fileContent = await fs.readFile("article.md");
    console.log("File content:", fileContent);
  } catch (err) {
    console.log("File read successfully");
  }
}

readFileContent();

/*
File content: <Buffer 23 23 20 4e 6f 64 65 20 60 66 73 60 20 4c 69 62 72 61 72 79 3a 20
 54 68 65 20 43 6f 6d 70 6c 65 74 65 20 47 75 69 64 65 0a 0a 49 6e 20 74 68 69 73 20 ... 
72 more bytes>
*/
```

在下一課中，你將學習如何使用 Node.js Buffer 模組來控制代碼這樣的緩衝區。

最後，`unlink()` 方法讓你刪除一個檔案：

```js
const fs = require("fs/promises");

async function deleteFile() {
  try {
    await fs.unlink("article.ts");
    console.log("File deleted successfully!");
  } catch (err) {
    console.error("Error deleting file:", err);
  }
}

deleteFile();
```

如果該檔案不存在，你會收到類似以下的錯誤訊息：

```bash
Error deleting file: Error: ENOENT: no such file or directory, unlink 'article.ts'
```

如果存在，該檔案會被刪除，並且你會收到你設定的成功訊息。

# --questions--

## --text--

Node `fs` 模組的主要用途是什麼？

## --answers--

在瀏覽器中創建動態 HTML 頁面。

### --feedback--

思考你如何直接從 Node.js 控制代碼像文字文件或資料夾這類檔案。

---

將 Node.js 連接到資料庫。

### --feedback--

思考你如何直接從 Node.js 控制代碼像文字文件或資料夾這類檔案。

---

與檔案系統互動以進行檔案和資料夾的 CRUD 操作。

---

管理 Node.js 軟體包安裝。

### --feedback--

思考你如何直接從 Node.js 控制代碼像文字文件或資料夾這類檔案。

## --video-solution--

3

## --text--

Node `fs` 模組中哪個方法可以讓你將內容寫入檔案，若該檔案不存在則會建立它？

## --answers--

`writeFile()`

---

`readFile()`

### --feedback--

思考同時創建並寫入內容到 `file` 的 `method`。

---

`appendFile()`

### --feedback--

思考同時創建並寫入內容到 `file` 的 `method`。

---

`unlink()`

### --feedback--

思考同時創建並寫入內容到 `file` 的 `method`。

## --video-solution--

1

## --text--

以下哪一項**不是**你可以在 Node 的 `fs` 模組中使用方法的三種方式之一？

## --answers--

使用回呼，例如 `fs.writeFile()`。

### --feedback--

兩個是非同步的，一個是同步的，一個不存在。

---

 使用 Promise，例如 `fs.promises.writeFile()`。

### --feedback--

兩個是非同步的，一個是同步的，一個不存在。

---

同步地，例如 `fs.writeFileSync()`。

### --feedback--

兩個是非同步的，一個是同步的，一個不存在。

---

使用 JSON 解析， 例如 `fs.parseFile()`。

## --video-solution--

4

