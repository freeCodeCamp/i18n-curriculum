---
id: 67d1ec6711b62f1cc5cc52e1
title: React 中的 Effects 是什麼，以及 `useEffect` 掛鉤如何運作？
challengeType: 19
dashedName: what-are-effects-in-react-and-how-does-the-useeffect-hook-work
---

# --description--

在 React 中，effect 是指發生在組件呈現過程之外的任何事情。也就是說，任何 React 不會直接作為呈現使用者介面一部分來控制的事情。

常見範例包括擷取資料、更新瀏覽器分頁的標題、從瀏覽器的區域儲存讀取或寫入資料、取得使用者的位置，還有更多。這些操作會與外部世界互動，稱為副作用。

React 提供了 `useEffect` 掛鉤，讓你控制那些副作用。`useEffect` 讓你在組件呈現或更新後執行一個函式。

讓我們看看 `useEffect` 掛鉤如何運作，以及為什麼它對現代 React 開發至關重要。

要使用 `useEffect` 掛鉤，首先你需要匯入它：

```js
import { useEffect } from "react";
```

然後你像這樣將它用作函式（程式）：

```js
useEffect(() => {
  // Your side effect logic (usually a function) here
}, [dependencies]);
```

當組件呈現後，effect 函式（程式）會執行，而選用的 `dependencies` 引數控制 effect 執行的時機。

請注意，`dependencies` 可以是「反應值」（狀態、屬性、函式、變數等等）的陣列、空陣列，或完全省略。以下說明所有這些選項如何控制 `useEffect` 的運作方式：

- 如果 `dependencies` 是包含一個或多個反應值的陣列，則每當它們改變時，該 effect 就會執行。

- 如果 `dependencies` 是空陣列，`useEffect` 僅在組件首次呈現時執行一次。

- 如果你省略 `dependencies`，該效果會在組件每次呈現或更新時執行。

例如，在這個 `Counter` 應用程式中，我們沒有傳入 `dependencies` 引數，所以該效果會在組件呈現及每次更新時執行：

```jsx
import { useState, useEffect } from "react";

const Counter = () => {
  const [count, setCount] = useState(0);

  useEffect(() => {
    console.log("Component renders");
  });

  return (
    <div
      style={{
        display: "flex",
        alignItems: "center",
        flexDirection: "column",
      }}
    >
      <h2>{count}</h2>
      <div>
        <button onClick={() => setCount(count + 1)}>Increase</button>
        <button onClick={() => setCount(count - 1)}>Decrease</button>
      </div>
    </div>
  );
};

export default Counter;
```

但如果我們傳入一個空的陣列作為相依性，該效果只會在第一次呈現時執行：

```js
useEffect(() => {
  console.log('Component renders');
}, []);
```

如果你將 `count` 狀態作為相依性傳入，該效果會在組件首次呈現時以及 `count` 變更時執行：

```js
useEffect(() => {
  document.title = `The current count is ${count}`;
  console.log('component renders');
}, [count]);
```

請注意，如果你設定的效果持續超過組件的呈現生命週期，你可能需要另一個函式在組件呈現或更新後「清理」該函式。

例如，如果你的效果函式（effect function）使用了 `setInterval()`、設定了像 `window.addEventListener()` 這樣的事件監聽器，或是連接到伺服器，你將需要一個清理函式來分別執行 `clearInterval()`、`window.removeEventListener()` 和斷開伺服器連接。

以下是從 `useEffect` 掛鉤傳回清理函式的語法：

```js
useEffect(() => {
  // Your side effect logic here
  return () => {
    // Cleanup logic here (optional)
  };
}, [dependencies]);
```

例如，如果你為滾動 `event` 添加監聽器，你可以在你的清理函式中透過移除它來進行清理：

```js
useEffect(() => {
  const handleScroll = () => {
    // Handle scroll logic
  };
  window.addEventListener("scroll", handleScroll);

  return () => {
    window.removeEventListener("scroll", handleScroll);
  };
}, []);
```

# --questions--

## --text--

在 React 中，什麼被視為 effect？

## --answers--

對組件狀態的任何更新。

### --feedback--

Effects 涉及 React 在呈現期間不控制的動作。

---

React 不會管理的呈現處理程序之外的操作行為。

---

在每次狀態更新後呈現 UI。

### --feedback--

Effects 涉及 React 在呈現期間不控制的動作。

---

更新組件的 props。

### --feedback--

Effects 涉及 React 在呈現期間不控制的動作。

## --video-solution--

2

## --text--

在 React 應用程式中，什麼決定副作用如何執行？

## --answers--

Effects 總是執行一次，無論依賴項為何。

### --feedback--

效果的行為取決於相依性陣列的內容。

---

Effects 只會在 props 改變時執行，忽略 state。

### --feedback--

效果的行為取決於相依性陣列的內容。

---

相依項陣列決定效果何時執行。

---

效果會在每次呈現時執行，除非明確地停用。

### --feedback--

效果的行為取決於相依性陣列的內容。

## --video-solution--

3

## --text--

React 中副作用的常見範例有哪些？

## --answers--

呈現組件和更新狀態。

### --feedback--

副作用涉及與 React 呈現處理程序之外的世界互動。

---

將 props 傳遞給子組件。

### --feedback--

副作用涉及與 React 呈現處理程序之外的世界互動。

---

定義組件樣式和版面配置。

### --feedback--

副作用涉及與 React 呈現處理程序之外的世界互動。

---

擷取資料、更新分頁標題，以及從儲存空間讀取。

## --video-solution--

4
