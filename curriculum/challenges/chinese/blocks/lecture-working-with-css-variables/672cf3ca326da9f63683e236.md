---
id: 672cf3ca326da9f63683e236
title: 什么是 @property 规则，它如何使用回退？
challengeType: 19
dashedName: what-is-the-at-property-rule
---

# --interactive--

`@property` 规则是一个强大的 CSS 特性，它允许开发人员定义自定义属性，从而更好地控制它们的行为，包括它们的动画方式和初始值。 

该规则提供了一种增强 CSS 自定义属性功能的方法，并为其应用提供了更大的灵活性。

`@property` 规则的基本语法如下：

```css
@property --property-name {
  syntax: '<type>';
  inherits: true | false;
  initial-value: <value>;
}
```

`--property-name` 是你定义的自定义属性的名称。 像所有自定义属性一样，它必须以两个连字符开始。 

`syntax` 定义属性的类型，可以是 `<color>`、`<length>`、`<number>`、`<percentage>` 或更复杂的类型。

`inherits` 指定属性是否应该从父元素继承它的值。 

`initial-value` 设置属性的默认值。

这是一个使用 `@property` 规则的实际示例：

:::interactive_editor

```html
<link rel="stylesheet" href="styles.css">
<button class="button">Click Me</button>
```

```css
@property --main-color {
  syntax: '<color>';
  inherits: false;
  initial-value: #3498db;
}

.button {
  background-color: var(--main-color);
}
```

:::

在这个例子中，我们定义了一个自定义属性 `--main-color` 作为`color` 值，设置它为不继承，并给它一个初始值 `#3498db`。

`@property` 规则的一个主要好处是，它允许自定义属性的动画化，这在以前是不可能的：

:::interactive_editor

```html
<link rel="stylesheet" href="styles.css">
<div class="gradient-box"></div>
```

```css
@property --gradient-angle {
  syntax: '<angle>';
  inherits: false;
  initial-value: 0deg;
}

.gradient-box {
  width: 100px;
  height: 100px;
  background: linear-gradient(var(--gradient-angle), red, blue);
  transition: --gradient-angle 0.5s;
}

.gradient-box:hover {
  --gradient-angle: 90deg;
}
```

:::

上面的代码创建了一个渐变，当元素悬停在上面时，它会平滑地显示动画，这是标准自定义属性无法实现的。

现在，让我们讨论一下 `@property` 规则是如何使用回退的。 

在 CSS 中，回退是至关重要的，它可以确保样式在不支持某些特性的浏览器中优雅地降级。 使用 `@property`，回退在两个级别上工作：对于规则本身和自定义属性的使用。

对于不支持 `@property` 规则的浏览器，你可以通过传统方式声明自定义属性来提供一个回退方案：

:::interactive_editor

```html
<link rel="stylesheet" href="styles.css">
```

```css
:root {
  --main-color: #3498db;
}

@property --main-color {
  syntax: '<color>';
  inherits: false;
  initial-value: #3498db;
}

body {
  background-color: var(--main-color);
}
```

:::

在这种情况下，支持 `@property` 的浏览器将使用更严格定义的版本，而其他浏览器将回退到标准的自定义属性声明。

在使用自定义属性时，可以调用 `var()` 函数提供一个回退值，就像使用标准自定义属性一样：

:::interactive_editor

```html
<link rel="stylesheet" href="styles.css">
<button class="button">Click Me</button>
```

```css
.button {
  background-color: var(--main-color, #3498db);
}
```

:::

这确保了即使 `--main-color` 属性没有被定义或无效，按钮仍将具有背景色。

`@property` 规则还允许更复杂的回退场景。 例如，你可以用它来提供类型安全的回退：

:::interactive_editor

```html
<link rel="stylesheet" href="styles.css">
<div class="box">Colored box</div>
```

```css
@property --padding {
  syntax: '<length>';
  inherits: false;
  initial-value: 10px;
}

.box {
  width: 100px;
  height: 100px;
  background-color: darkred;
  color: white;
  padding: var(--padding);
}
```

:::

在这种情况下，如果有人试图将 `--padding` 设置为无效值，例如颜色，浏览器将回退到 `10px` 的初始值，以保持类型安全。

自 2024 年初以来，CSS `@property` 规则被认为在所有主要现代浏览器引擎（如 Chrome、Edge、Opera、Firefox 和 Safari）中广泛可用。如果你想支持更早的浏览器，则需要提供如上所述的备用 CSS。

总之，`@property` 规则代表了我们在 CSS 中处理自定义属性方面的一个重大进步。 它提供了更多的控制，并支持新的可能性，如自定义属性的动画。 然而，明智地使用它并始终提供适当的回退以确保在所有浏览器中都有良好的体验是很重要的。 与任何前沿的 web 技术一样，关键是增强支持它的浏览器的体验，同时确保不支持它的浏览器的基本功能。

# --questions--

## --text--

CSS 中 `@property` 规则的主要目的是什么？

## --answers--

创建新的 CSS 属性。

### --feedback--

想想 `@property` 如何与自定义 CSS 属性相关联。

---

定义和控制自定义属性的行为。

---

替换标准 CSS 属性。

### --feedback--

想想 `@property` 如何与自定义 CSS 属性相关联。

---

创建动画。

### --feedback--

想想 `@property` 如何与自定义 CSS 属性相关联。

## --video-solution--

2

## --text--

以下哪一项在 `@property` 规则中不是有效的描述符？

## --answers--

`syntax`

### --feedback--

考虑一下 `@property` 规则声明的基本结构。

---

`inherits`

### --feedback--

考虑一下 `@property` 规则声明的基本结构。

---

`initial-value`

### --feedback--

考虑一下 `@property` 规则声明的基本结构。

---

`animation`

## --video-solution--

4

## --text--

如何为不支持 `@property` 规则的浏览器提供回退？

## --answers--

使用填充物。

### --feedback--

想想如果没有`@property`，你通常会如何声明一个自定义属性。

---

使用标准方法声明自定义属性。

---

使用 `@supports` 规则。

### --feedback--

想想如果没有`@property`，你通常会如何声明一个自定义属性。

---

无法提供回退。

### --feedback--

想想如果没有`@property`，你通常会如何声明一个自定义属性。

## --video-solution--

2
