---
id: 67fe85a1b634a335b18ae09a
title: Python 中的範圍是什麼以及它如何運作？
challengeType: 19
dashedName: what-is-scope-in-python-and-how-does-it-work
---

# --description--

在 Python 中，作用域決定你可以存取變數的時機。它控制變數的生命週期以及變數在程式碼不同部分中的決議方式。

為了正確判斷範圍、Python 遵循 **LEGB** 規則，該規則代表以下內容：

- **區域的範圍 (L)**：在函式（程式）或類別中定義的變數。
    
- **封閉作用域（E）**：定義於封閉或巢狀函式中的變數。
    
- **全域的範圍 (G)：** 在模組或檔案頂層定義的變數。
    
- **內建範圍（B）**：Python 中為預定義函式（程式）、模組、關鍵字和物件保留的名稱。

Python 使用 LEGB 規則來決議你程式中變數的作用域。我們將深入探討這些規則，以便你更好地理解這個處理程序。

**區域的範圍** 意味著在函式（程式）或類別內宣告的變數只能在該函式（程式）或類別內被存取。

這裡有一個範例：

```python
def my_func():
    my_var = 10
    print(my_var)
```

在這種情況下，`my_func` 函式有自己的作用域，無法從函式外部存取。呼叫 `my_func` 會輸出 `10`，但在函式外列印 `my_var` 會導致 `NameError`：

```python
def my_func():
    my_var = 10 # Locally scoped to my_func
    print(my_var)

my_func() # 10

print(my_var) # NameError: name 'my_var' is not defined
```

**包覆作用域** 意味著巢狀在另一個函式（程式）內的函式（程式）可以存取它所巢狀的函式（程式）的變數。

例如：

```python
def outer_func():
    msg = 'Hello there!'

    def inner_func():
        print(msg)

    inner_func()

outer_func() # Hello there!
```

在此範例中，內部函式（程式）`inner_func` 可以自由存取在外部函式（程式）`outer_func` 中定義的 `msg` 變數。然而，請注意外部函式（程式）無法存取在任何巢狀函式（程式）中定義的變數：

```python
def outer_func():
    msg = 'Hello there!'
    print(res)

    def inner_func():
        res = 'How are you?'
        print(msg)

    inner_func()

outer_func() # NameError: name 'res' is not defined
```

那是因為 `res` 是區域的範圍於 `inner_func`。另外，請注意 `outer_func` 嘗試在呼叫 `inner_func` 之前列印 `res`。

一個解法是在包含的作用域，也就是 `outer_func` 內，將 `res` 初始化為空字串。然後在 `inner_func` 中，使用 `nonlocal` 關鍵字將 `res` 設為非區域的變數：

```python
def outer_func():
    msg = 'Hello there!'
    res = ""  # Declare res in the enclosing scope

    def inner_func():
        nonlocal res  # Allow modification of an enclosing variable
        res = 'How are you?'
        print(msg)  # Accessing msg from outer_func()

    inner_func()
    print(res)  # Now res is accessible and modified

outer_func()

# Output:
# Hello there!
# How are you?
```

**全域的作用域** 指的是宣告在任何函式或類別外的變數，這些變數可以在程式中的任何地方被存取。這裡，`my_var` 可以在任何地方被存取，即使是在未定義它的函式內：

```python
my_var = 100

def show_var():
    print(my_var)

show_var() # 100
print(my_var) # 100
```

如果你想讓在函式內定義的區域的變數可以全域存取，你可以使用 `global` 關鍵字：

```python
my_var_1 = 7

def show_vars():
    global my_var_2
    my_var_2 = 10
    print(my_var_1)
    print(my_var_2)

show_vars() # 7 10

# my_var_2 is now a global variable and can be accessed anywhere in the program
print(my_var_2) # 10
```

你也可以使用 `global` 關鍵字來修改全域變數：

```python
my_var = 10  # A global variable

def change_var():
    global my_var  # Allows modification of a global variable
    my_var = 20

change_var()

print(my_var)  # my_var is now modified globally to 20
```

最後，**內建作用域** 指的是 Python 所有的內建函式（程式）、模組和關鍵字，並且在你的程式中任何地方都可用：

```python
print(str(45)) # '45'
print(type(3.14)) # <class 'float'>
print(isinstance(3, str)) # False
```

# --questions--

## --text--

Python 遵循什麼規則來決定變數的範圍？

## --answers--

堆疊：靜態、暫時、作用中、常數、關鍵字

### --feedback--

它由四個層次組成，從最具體到最一般。

---

樹狀結構：暫時的、保留的、包覆的、外部的

### --feedback--

它由四個層次組成，從最具體到最一般。

---

LEGB：區域的、封閉的、全域的、內建的

---

範圍、作用域：Script、Constant、Outer、Python、Embedded

### --feedback--

它由四個層次組成，從最具體到最一般。

## --video-solution--

3

## --text--

`nonlocal` 關鍵字的作用是什麼？

## --answers--

使變數成為全域的。

### --feedback--

它有助於修改外部函式中的變數。

---

創建一個新的區域的變數。

### --feedback--

它有助於修改外部函式中的變數。

---

防止變數重新指定。

### --feedback--

它有助於修改外部函式中的變數。

---

允許修改封閉函式中的變數

## --video-solution--

4

## --text--

你可以使用哪個關鍵字來修改 Python 中的全域變數？

## --answers--

`global`

---

`local`

### --feedback--

它允許在函式外部變更變數。

---

`static`

### --feedback--

它允許在函式外部變更變數。

---

`nonlocal`

### --feedback--

它允許在函式外部變更變數。

## --video-solution--

1
