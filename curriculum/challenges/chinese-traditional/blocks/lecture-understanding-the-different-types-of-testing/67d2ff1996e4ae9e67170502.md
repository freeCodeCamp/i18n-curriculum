---
id: 67d2ff1996e4ae9e67170502
title: 什麼是單元測試？
challengeType: 19
dashedName: what-is-unit-testing
---

# --description--

當你設計你的應用程式時，你經常會有一系列負責單一任務的小函式（程式）。這被稱為「單一職責原則」。當你有一系列小函式時，最好測試這些函式以確保一切如預期運作。在本課程中，我們將探討如何使用流行的 `Jest` 測試框架來創建單元測試。

在此範例中，我們將創建一個負責傳回新格式化字串的函式（程式）：

```js
export function getFormattedWord(str) {
  if (!str) return '';
  return str.charAt(0).toUpperCase() + str.slice(1);
}
```

這個 `getFormattedWord` 函式有一個名為 `str` 的參數，並且會先檢查 `str` 是否為空。如果是，則傳回一個空字串。否則，會傳回一個新的字串，其中第一個字母已大寫。我們正在匯出這個函式，以便在測試檔案中使用它。

在一個獨立的 `getFormattedWord.test.js` 檔案中，我們可以撰寫一些測試來驗證該函式是否如預期般運作。

在 `getFormattedWord.test.js` 檔案的頂部，我們需要先這樣匯入函式（程式）：

```js
import { getFormattedWord } from "./getFormattedWord.js";
```

接著我們需要使用 `npm i jest` 安裝 Jest 軟體包。然後我們可以新增一個測試，檢查由小寫字元組成的字 `hello` 是否正確格式化為以大寫 `H` 開頭的 `Hello`：

```js
test('capitalizes the first letter of a word', () => {
  expect(getFormattedWord('hello')).toBe('Hello');
});
```

`expect` 函式用來測試一個值。它會與一個 matcher 結合，matcher 是一個函式，用來檢查該值是否如預期般運作。在這個例子中，matcher 是 `toBe()`。Jest 有各種 matcher 幫助你測試真值、字串、數字等等。

執行測試的一種方法是為你的 `package.json` 檔案添加 npm 腳本。以下是 Jest 框架的範例腳本：

```js
"scripts": {
  "test": "jest"
},
```

然後只要在你的終端機中執行 `npm run test` 來執行你的測試。如果你的測試通過，你應該會在終端機中看到類似這樣的內容：

```sh
PASS ./getFormattedWord.test.js
  ✓ capitalizes the first letter of a word (1 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.103 s, estimated 1 s
Ran all test suites.
```

要查看失敗測試的樣子，我們可以故意將函式更新為以下內容來破壞測試：

```js
export function getFormattedWord(str) {
  if (!str) return '';
  return "This is incorrect";
}
```

現在當你執行 `npm run test` 指令時，會出現錯誤訊息，因為測試預期的結果不同：

```sh
FAIL ./getFormattedWord.test.js
  ✕ capitalizes the first letter of a word (1 ms)

  ● capitalizes the first letter of a word

  expect(received).toBe(expected) // Object.is equality

  Expected: "Hello"
  Received: "This is incorrect"

    2 |
    3 | test('capitalizes the first letter of a word', () => {
    4 |   expect(getFormattedWord('hello')).toBe('Hello');
                                            ^
    5 | });
    6 |

    at Object.toBe (getFormattedWord.test.js:4:37)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.121 s, estimated 1 s
Ran all test suites.
```

現在我們可以將我們的函式（程式）更新回原本的內容：

```js
export function getFormattedWord(str) {
  if (!str) return '';
  return str.charAt(0).toUpperCase() + str.slice(1);
}
```

為你的 `getFormattedWord` 添加另一個測試，以檢查未提供任何引數的情況：

```js
test("returns an empty string when no argument is provided", () => {
  expect(getFormattedWord()).toBe("");
});
```

你可以添加其他測試來使事情更強固，但這前幾個測試是單元測試的良好入門。

在測試 JavaScript 應用程式時，一些常見的測試框架包括 Jest、Mocha 和 Vitest。

單元測試很重要，因為它能幫助你在你的程式中捕捉更多錯誤，並確保一切如預期般運作。它也可以作為你的應用程式的一種文件形式，因為它旨在表述你的程式的預期行為。

# --questions--

## --text--

以下哪一項取用函式應該只負責一件事的原則？

## --answers--

單一職責原則

---

多重職責原則

### --feedback--

回到課程一開始討論這個內容的地方取用。

---

單一請求原則

### --feedback--

回到課程一開始討論這個內容的地方取用。

---

多重回應原則

### --feedback--

回到課程一開始討論這個內容的地方取用。

## --video-solution--

1

## --text--

以下哪一項不是 JavaScript 生態系中常用的測試框架？

## --answers--

JUnit

---

Jest

### --feedback--

請回到課程結尾處，該處有討論此內容。

---

Vitest

### --feedback--

請回到課程結尾處，該處有討論此內容。

---

Mocha

### --feedback--

請回到課程結尾處，該處有討論此內容。

## --video-solution--

1

## --text--

你可以為你的 `package.json` 檔案添加什麼來在終端機中執行你的測試？

## --answers--

```json
"test": {
  "test": "run test"
},
```

### --feedback--

請記得你可以在你的 `package.json` 檔案中創建訂製腳本。

---

```json
"scriptings": {
  "jest"
},
```

### --feedback--

請記得你可以在你的 `package.json` 檔案中創建訂製腳本。

---

```json
"run": {
  "test"
},
```

### --feedback--

請記得你可以在你的 `package.json` 檔案中創建訂製腳本。

---

```json
"scripts": {
  "test": "jest"
}
```

## --video-solution--

4
