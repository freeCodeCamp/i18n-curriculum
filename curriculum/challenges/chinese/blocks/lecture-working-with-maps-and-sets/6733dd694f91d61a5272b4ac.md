---
id: 6733dd694f91d61a5272b4ac
title: 什么是 `Map` 对象，它与 `WeakMap` 有何不同？
challengeType: 19
dashedName: what-is-the-map-object-and-how-does-it-differ-from-weakmaps
---

# --description--

在 JavaScript 中，`Map` 是一个内置对象，用于保存键值对，类似于对象。然而，它不同于标准的 JavaScript 对象，因为它允许任何类型的键，包括对象和函数。

`WeakMap` 是一个键值点对的集合，类似于 `Map`，但它对键使用弱引用。键必须是对象，而值可以是任何类型。

将 `WeakMap` 和 `Map` 之间的关系视为类似于你在上一课中学到的 `WeakSet` 和 `Set` 之间的关系。

要创建一个 `Map`，你需要使用带有 `new` 关键字的 `Map()` 构造函数：

```js
const myFirstMap = new Map();
```

你可以用值初始化 `Map` ：

```js
const myTreesMap = new Map([
 [{ type: 'deciduous' }, 'Maple tree'],
 [['forest', 'grove'], 'Pine tree'],
 [42, 'Oak tree'],
 [true, 'Birch tree'],
 [function() { return 'I am a function key'; }, 'Willow tree'],
]);
```

如果你没有用值初始化 `Map`，你可以使用 `set()` 方法为它们添加值：

```js
const myTreesMap = new Map();
myTreesMap.set({ type: 'deciduous' }, 'Maple tree');
myTreesMap.set([1, 2], 'Pine tree');
myTreesMap.set(42, 'Oak tree');
myTreesMap.set(true, 'Birch tree');
myTreesMap.set(function() { return "I'm a function key"; }, 'Willow tree');

console.log(myTreesMap);
```

下面是在控制台中 `Map` 的样子：

```js
/*
Map(5) {{…} => 'Maple tree', Array(2) => 'Pine tree', 42 => 'Oak tree', true => 'Birch tree', ƒ => 'Willow tree'}
  [[Entries]]
    0:{Object => "Maple tree"}
      key: {type: 'deciduous'}
      value: "Maple tree"
    1:{Array(2) => "Pine tree"}
      key: (2)
      value: "Pine tree"
    2:{42 => "Oak tree"}
      key: 42
      value: "Oak tree"
    3:{true => "Birch tree"}
      key: true
      value: "Birch tree"
    4:{function () { return "I'm a function key"; } => "Willow tree"}
      key: f ()
      value: "Willow tree"
    size: 5
    [[Prototype]]: Map
*/
```

你可以用来操作 `Map` 的其他方法有：

- 使用 `get(key)` 来检索与指定 `key` 关联的值。
- 使用 `has(key)` 来查看 `Map` 中是否存在某个 `key`。
- `delete(key)` 用于从 `Map` 中移除一个键值点对。
- `clear()` 用于移除所有密钥-值点对。
- 使用 `entries()` 查看 `Map` 的条目（它返回一个 `MapIterator` 中的条目）。
- 使用 `forEach()` 循环遍历 `Map` 的条目。
- `size` 表示 `Map` 中的键值点对数量。
    

有一个 `WeakMap()` 构造函数，你可以用它来创建一个 `WeakMap`：

```js
const myFirstWeakMap = new WeakMap();
```

`set()`、`get()`、`has()` 和 `delete()` 方法也都可以用于 `WeakMap`。例如，下面是如何使用 `set()` 方法为 `Map` 赋值项：

```js
const myTreeWeakMap = new WeakMap();

myTreeWeakMap.set({ id: 1 }, 'Maple tree');
myTreeWeakMap.set({ id: 2 }, 'Pine tree');
myTreeWeakMap.set({ id: 3 }, 'Oak tree');
myTreeWeakMap.set({ id: 4 }, 'Birch tree');
myTreeWeakMap.set({ id: 5 }, 'Willow tree');

console.log(myTreeWeakMap);
```

下面是在控制台中 `WeakMap` 的样子：

```js
/*
WeakMap {{…} => 'Willow tree', {…} => 'Maple tree', {…} => 'Pine tree', {…} => 'Oak tree'}
  [[Entries]]
    No properties
  [[Prototype]]: WeakMap
*/
```

以下是 `Map` 和 `WeakMap` 之间的区别：

| **Feature** | **Map** | **WeakMap** |
| --- | --- | --- |
| **Key Type** | Keys can be of any data type, including strings, numbers, objects, or even functions. | Keys must be objects. |
| **Use Case** | Use a `Map` when you need to associate data with any type of key. | Use a `WeakMap` when you only need to associate data with objects. |
| **Iteration** | You can loop through a `Map` using `forEach()`, `keys()`, `values()`, or `entries()`. | A `WeakMap` is not iterable. |
| **Size Property** | `Map` has a `size` property to get the number of key-value pairs. | `WeakMap` does not have a `size` property. |

在上表中，你可以看到包括密钥类型、使用分支、迭代和大小属性在内的差异总结。请花一点时间阅读此表内容，以了解它们的区别。

# --questions--

## --text--

以下哪项区分了 JavaScript 中的 `Map` 和 `WeakMap`？

## --answers--

`Map` 只允许对象作为密钥，而 `WeakMap` 允许任何类型的密钥。

### --feedback--

考虑允许的密钥类型以及引用是如何被处理的。

---

`Map` 对密钥有弱引用，而 `WeakMap` 没有。

### --feedback--

考虑允许的密钥类型以及引用是如何被处理的。

---

`Map` 允许任何类型的密钥，而 `WeakMap` 只允许对象作为密钥。

---

`Map` 和 `WeakMap` 的函数完全相同。

### --feedback--

考虑允许的密钥类型以及引用是如何被处理的。

## --video-solution--

3

## --text--

哪个属性让你知道 `Map` 中的项数？

## --answers--

`length`

### --feedback--

考虑用于测量 `Map` 中条目数量的属性。

---

`count`

### --feedback--

考虑用于测量 `Map` 中条目数量的属性。

---

`total`

### --feedback--

考虑用于测量 `Map` 中条目数量的属性。

---

`size`

## --video-solution--

4

## --text--

哪个方法让你为 `Map` 和 `WeakMap` 添加一项？

## --answers--

`add()`

### --feedback--

考虑专门用于将键值对添加到 `Map` 的方法。

---

`push()`

### --feedback--

考虑专门用于将键值对添加到 `Map` 的方法。

---

`set()`

---

`insert()`

### --feedback--

考虑专门用于将键值对添加到 `Map` 的方法。

## --video-solution--

3
