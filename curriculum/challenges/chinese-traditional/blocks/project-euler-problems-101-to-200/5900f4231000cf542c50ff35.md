---
id: 5900f4231000cf542c50ff35
title: '問題 182：RSA 加密'
challengeType: 1
forumTopicId: 301818
dashedName: problem-182-rsa-encryption
---

# --description--

RSA 加密是基於以下程序：

產生兩個不同的質數 `p` 和 `q`。  
計算 `n=p*q` 和 `φ=(p-1)(q-1)`。  
尋找一個整數 `e`，使得 `1 < e < φ` 且 `gcd(e,φ) = 1`。

此系統中的一個訊息是在區間 `[0,n-1]` 內的數字。  
要加密的文字接著會以某種方式轉換成訊息（區間 `[0,n-1]` 內的數字）。  
為了加密文字，對每個訊息 `m`，計算 c=m<sup>e</sup> mod n。

要解密文字，需要以下程序：計算 `d` 使得 `ed=1 mod φ`，然後對每個加密的訊息 `c`，計算 m=c<sup>d</sup> mod n。

存在某些 `e` 和 `m` 的值，使得 m<sup>e</sup> mod n = m。  
我們稱對於 m<sup>e</sup> mod n=m 的 `m` 為無隱藏的訊息。

選擇 `e` 時的一個問題是不能有太多未加密的訊息。  
例如，令 `p=19` 和 `q=37`。  
則 `n=19*37=703` 且 `φ=18*36=648`。  
如果我們選擇 `e=181`，則雖然 `gcd(181,648)=1`，但計算 m<sup>e</sup> mod n 時，所有可能的訊息 m `(0≤m≤n-1)` 都是未加密的。  
對於任何有效的 `e` 選擇，都存在一些未加密的訊息。  
重要的是未加密訊息的數量要盡可能少。

對於任意給定的 `p` 和 `q`，找出所有 `e` 的總和，條件為 `1 < e < φ(p,q)` 且 `gcd(e,φ)=1`，使得此 `e` 的非隱藏訊息數量達到最小。

# --hints--

`RSAEncryption` 應該是一個函式（程式）。

```js
assert.isFunction(RSAEncryption);
```

`RSAEncryption` 應該傳回一個數字。

```js
assert.strictEqual(typeof RSAEncryption(19, 37), 'number');
```

`RSAEncryption(19, 37)` 應該傳回 `17766`。

```js
assert.strictEqual(RSAEncryption(19, 37), 17766);
```

`RSAEncryption(283, 409)` 應該傳回 `466196580`。

```js
assert.strictEqual(RSAEncryption(283, 409), 466196580);
```

`RSAEncryption(1009, 3643)` 應該傳回 `399788195976`。

```js
assert.strictEqual(RSAEncryption(19, 37), 17766);
```

# --seed--

## --seed-contents--

```js
function RSAEncryption(p, q) {

  return true;
}

RSAEncryption(19, 37);
```

# --solutions--

```js
function gcd(a, b) {
    if (b)
        return gcd(b, a % b);
    else
        return a;
}

function RSAEncryption(p, q) {
    let phi = (p - 1) * (q - 1);

    let best = Number.MAX_SAFE_INTEGER;
    let sum = 0;

    for (let e = 0; e < phi; ++e) {
        if (!(gcd(e, phi) == 1))
            continue;

        let msg = (gcd(p - 1, e - 1) + 1) * (gcd(q - 1, e - 1) + 1);

        if (best == msg) {
            sum += e;
        } else if (best > msg) {
            best = msg;
            sum = e;
        }
    }

    return sum;
}
```
