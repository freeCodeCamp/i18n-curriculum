---
id: 68420be9af9d89620af7944a
title: 什么是面向对象编程，封装是如何工作的？
challengeType: 19
dashedName: what-is-object-oriented-programming-and-how-does-encapsulation-work
---

# --description--

面向对象编程，也称为 OOP，是一种编程风格，开发者将代码中的所有内容视为现实世界中的对象。

类就像是用于创建对象的蓝图。每个由类创建的对象都有定义数据的属性和定义对象行为的方法。

在之前的课程中，你学习了如何创建类。这里是语法的提醒：

```py
class ClassName:
   def __init__(self, parameters):
       attribute = value

   def method_name(self):
       # method logic
```

这是一个类的示例，该类使用 `__init__` 特殊方法在使用该类创建对象时初始化品牌和颜色属性：

```py
class Car:
   def __init__(self, brand, color):
       self.brand = brand
       self.color = color

# create two objects from the Car class
car1 = Car('Toyota', 'red')
car2 = Car('Lambo', 'green')

print('Car 1 Brand:', car1.brand) # Car 1 Brand: Toyota
print('Car 1 Color:', car1.color) # Car 1 Color: red

print('Car 2 Brand:', car2.brand) # Car 2 Brand: Lambo
print('Car 2 Color:', car2.color) # Car 2 Color: green
```

面向对象编程有四个关键原则，帮助你有效地组织和管理代码。它们是封装、继承、多态和抽象。

本课的其余部分将重点介绍封装的工作原理。

封装是将一个对象的属性和方法捆绑到一个单一单元——类中。

通过封装，你可以将对象的内部状态隐藏在一组简单的公共方法和属性后面，这些方法和属性就像门一样。在这些门后面是私有属性和方法，它们控制数据如何变化以及谁可以查看数据。

假设你想跟踪一个钱包余额。你想允许人们向钱包存入或取出资金，但任何人都不应该能够直接篡改余额。

在这种情况下，你可以将 `deposit()` 和 `withdraw()` 设为公共方法，并将余额隐藏在 `_balance` 属性下：

```py
class Wallet:
   def __init__(self, balance):
       self._balance = balance # For internal use by convention

   def deposit(self, amount):
       if amount > 0:
           self._balance += amount # Add to the balance safely

   def withdraw(self, amount):
       if 0 < amount <= self._balance:
           self._balance -= amount # Remove from the balance safely
```

按照惯例，属性和方法前加单个下划线表示它们是供内部使用的。任何人都不应从类外部直接访问它们，因为这违背了封装原则，可能导致错误。

虽然单个下划线前缀只是一个约定，但用双下划线前缀属性和方法实际上可以防止它们被类外部访问，使这些属性和方法成为私有的。

```py
class Wallet:
   def __init__(self, balance):
       self.__balance = balance # Private attribute

   def deposit(self, amount):
       if amount > 0:
           self.__balance += amount # Add to the balance safely

   def withdraw(self, amount):
       if 0 < amount <= self.__balance:
           self.__balance -= amount # Remove from the balance safely

account = Wallet(500)
print(account.__balance) # AttributeError: 'Wallet' object has no attribute '__balance'
```

要获取 `__balance` 的当前值，你可以定义一个 get_balance 方法。例如：

```py
class Wallet:
   def __init__(self, balance):
       self.__balance = balance

   def deposit(self, amount):
       if amount > 0:
           self.__balance += amount

   def withdraw(self, amount):
       if 0 < amount <= self.__balance:
           self.__balance -= amount
  
   def get_balance(self):
       return self.__balance


acct_one = Wallet(100)
acct_one.deposit(50)
print(acct_one.get_balance()) # 150

acct_two = Wallet(450)
acct_two.withdraw(28)
print(acct_two.get_balance()) # 422

acct_two.deposit(150)
print(acct_two.get_balance()) # 572
```

你也可以定义一个私有的 `__validate` 方法来查看每笔存款或取款金额是否为正数：

```py
class Wallet:
   def __init__(self):
       self.__balance = 0

   def __validate(self, amount):
       if amount < 0:
           raise ValueError('Amount must be positive')

   def deposit(self, amount):
       self.__validate(amount)
       self.__balance += amount

   def withdraw(self, amount):
       self.__validate(amount)
       if amount > self.__balance:
           raise ValueError('Insufficient funds')
       self.__balance -= amount

   def get_balance(self):
       return self.__balance

acct_one = Wallet()
acct_one.deposit(3)
print(acct_one.get_balance()) # 3

acct_one.deposit(50)
print(acct_one.get_balance()) # 53

acct_one.deposit(-4)  # ValueError: Amount must be positive
acct_one.withdraw(-8) # ValueError: Amount must be positive
acct_one.withdraw(58) # ValueError: Insufficient funds
```

如你所见，`__validate` 方法是私有的，并且在 `deposit()` 和 `withdraw()` 公共方法中后台运行，以确保金额始终有效。

在即将到来的课程中，你将学习更多关于以双下划线开头的属性如何工作的内容。

总之，封装通过清晰的公共方法将内部数据锁定起来。这就是你如何保护你的类免受篡改并将验证集中在一个地方的方式。你可以自由地更新或扩展你的代码，因为外部代码只会接触你暴露的接口。

# --questions--

## --text--

面向对象编程（OOP）的四个关键原则是什么？

## --answers--

封装、继承、多态、抽象

---

变量、函数、循环、条件式

### --feedback--

注意那些定义面向对象编程中数据和行为组织方式的原则。

---

类、对象、方法、属性

### --feedback--

注意那些定义面向对象编程中数据和行为组织方式的原则。

---

公共、私有、受保护、静态

### --feedback--

注意那些定义面向对象编程中数据和行为组织方式的原则。

## --video-solution--

1

## --text--

为什么直接访问以单个下划线开头的属性/方法是不好的做法？

## --answers--

因为如果你尝试，Python 会引起 `syntax error`。

### --feedback--

考虑封装如何存在以保护对象的内部状态。

---

因为它违反了封装，允许不受控的数据访问。

---

因为私有属性的访问比公共属性更慢。

### --feedback--

考虑封装如何存在以保护对象的内部状态。

---

因为它们只能从子类中访问。

### --feedback--

因为它们只能从子类中访问。

## --video-solution--

2

## --text--

表示私有属性或方法的方式是什么？

## --answers--

前缀为单个下划线

### --feedback--

注意用于前缀私有属性或方法名称的符号。

---

使用前导和尾随双下划线

### --feedback--

注意用于前缀私有属性或方法名称的符号。

---

以双下划线作为前缀

---

使用 private 关键字

### --feedback--

注意用于前缀私有属性或方法名称的符号。

## --video-solution--

3

