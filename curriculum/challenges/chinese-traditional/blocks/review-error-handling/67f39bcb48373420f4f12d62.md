---
id: 67f39bcb48373420f4f12d62
title: 錯誤處理審查
challengeType: 31
dashedName: review-error-handling
---

# --description--

## Python 中的常見錯誤

- **SyntaxError**：當你的程式碼不符合其語法規則時，Python 引發的錯誤。 例如，程式碼 `print("Hello there"` 會導致語法錯誤，並顯示訊息 `SyntaxError: '(' was never closed`，因為程式碼缺少關閉的括號。
- **NameError**：當你嘗試存取尚未定義的變數或函式時，Python 會引發 `NameError`。例如，如果你的程式碼中有 `print(username)` 這一行，但你並未先定義 `username` 變數，你將會收到帶有訊息 `NameError: name 'username' is not defined` 的名稱錯誤。
- **TypeError**：當你對兩個或多個不相容的資料型別執行操作時，Python 會發出這個錯誤。例如，如果你嘗試將字串加到數字上，你會得到錯誤 `TypeError: can only concatenate str (not "int") to str`。
- **IndexError**：如果你存取列表或其他序列（例如 tuple 和字串）中不存在的索引，就會得到 `IndexError`。例如，在 `Hello world` 字串中，最後一個字元的索引是 `11`。如果你繼續這樣存取字元，`greet = "hello world"; print(greet[12])`，你會得到訊息為 `IndexError: string index out of range` 的錯誤。
- **AttributeError**：當你嘗試在該型別的物件中使用不存在的方法或屬性時，Python 會引發此錯誤。<dfn>例如</dfn>，在字串 `"hello".append("!")` 上呼叫 `.append()` 會導致錯誤，並顯示訊息 `AttributeError: 'str' object has no attribute 'append'`。

## Python 中良好的偵錯技巧

- **使用 `print` 函式**：在偵錯時，將 `print()` 述語插入程式碼中各個位置，有助於你查看變數的值以及程式碼的流程。
- **使用 Python 內建的除錯器 (`pdb`)**：Python 提供了 `pdb` 模組用於偵錯。它是 Python 標準程式庫的零件，因此你隨時都可以使用。使用 `pdb`，你可以透過 `set_trace()` 方法設定追蹤點，這樣你就可以開始逐步執行程式碼並以互動方式檢查變數。
- **利用整合開發環境偵錯工具**：許多整合開發環境（IDE）和程式碼編輯器，如 Pycharm 和 VS Code，提供具有中斷點、逐步執行、變數檢查及其他偵錯特性的偵錯工具。

## 例外處理

- **`try...except`**: This is used to execute a block of code that might raise an exception. The `try` block is  where you anticipate an error might occur, while the `except` block takes a specified exception and runs if that specified error is raised. Here's an example:

  ```py
  try:
    print(22 / 0)
  except ZeroDivisionError:
    print('You can\'t divide by zero!')
    # You can't divide by zero!
  ```

  You can also chain multiple `except` blocks so you can handle more types of exceptions:

  ```py
  try:
    number = int(input('Enter a number: '))
    print(22 / number)
  except ZeroDivisionError:
    print('You cannot divide by zero!')
    # You cannot divide by zero! prints when you enter 0
  except ValueError:
    print('Please enter a valid number!')
    # Please enter a valid number! prints when you enter a string  
  ```

- **`else` 和 `finally`**：這些區塊擴充了 `try...except`。如果沒有發生例外，則會執行 `else` 區塊。無論是否有錯誤，`finally` 區塊都會執行。

  ```py
  try:
    result = 100 / 4
  except ZeroDivisionError:
    print('You cannot divide by zero!') # This will not run
  else:
    print(f'Result is {result}') # Result is 25.0
  finally:
    print('Execution complete!') # Execution complete!
  ```

- **例外物件**：這讓你能存取例外本身，以便更好地偵錯和列印直接的錯誤訊息。要存取例外物件，你需要使用 `as` 關鍵字。以下是一個範例：

  ```py
  try:
      value = int('This will raise an error')
  except ValueError as e:
      print(f'Caught an error: {e}')
      # Caught an error: invalid literal for int() with base 10: 'This will raise an error'
  ```

- **`raise` 述語**：這讓你可以手動引發例外。當符合某個條件時，你可以使用它來丟出例外。以下是一個範例：

  ```py
  def divide(a, b):
      if b == 0:
          raise ZeroDivisionError('You cannot divide by zero')
      return a / b
  ```
  
## 例外信號
  
  當你創建自己的訂製例外時，`raise` 述語也很有用，因為你可以用它來發出帶有訂製訊息的例外。以下是一個範例：

  ```py
  class InvalidCredentialsError(Exception):
      def __init__(self, message="Invalid username or password"):
          self.message = message
          super().__init__(self.message)

  def login(username, password):
      stored_username = "admin"
      stored_password = "password123"
      
      if username != stored_username or password != stored_password:
          raise InvalidCredentialsError()
      
      return f"Welcome, {username}!"
  ```  

  以下是你如何使用來自 `InvalidCredentialsError` 例外的 `login` 函式（程式）：

  ```py
  # failed login attempt
  try:
      message = login("user", "wrongpassword")
      print(message)
  except InvalidCredentialsError as e:
      print(f"Login failed: {e}")

  # successful login attempt
  try:
      message = login("admin", "password123")
      print(message)
  except InvalidCredentialsError as e:
      # This block is not executed because the login was successful
      print(f"Login failed: {e}")
  else:
      # The else block runs if the 'try' block completes without an exception
      print(message)
  ```

  `raise` 述語也可以與 `from` 字一起使用，以串鏈例外，顯示不同錯誤之間的關係：

  ```py
  def parse_config(filename):
    try:
        with open(filename, 'r') as file:
            data = file.read()
            return int(data)
    except FileNotFoundError:
        raise ValueError('Configuration file is missing') from None
    except ValueError as e:
        raise ValueError('Invalid configuration format') from e

  config = parse_config('config.txt')
  ```

# --assignment--

檢視錯誤處理主題和概念。
