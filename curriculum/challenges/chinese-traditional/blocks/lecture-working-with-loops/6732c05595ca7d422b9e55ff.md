---
id: 6732c05595ca7d422b9e55ff
title: 什麼是 For...in 迴圈，以及你應該何時使用它？
challengeType: 19
dashedName: what-is-the-for-in-loop-and-when-should-you-use-it
---

# --interactive--

當你需要對物件的屬性進行迴圈時，`for...in` 迴圈是最佳選擇。此迴圈會迭代物件的所有可列舉屬性，包括繼承的屬性和非數字屬性。

繼承屬性是從物件的原型串鏈繼承而來的屬性。非數字屬性是指不是數字或無法轉換為數字的字串的屬性。

以下是 `for...in` 迴圈的基本語法：

```js
for (variable in object) {
  // code block to be executed
}
```

範例中的變數表述正在被迴圈處理的物件的當前屬性。

讓我們來看幾個範例，這樣你就能更好地理解 `for...in` 迴圈的運作方式。

在這個第一個範例中，我們有一個 `fruit` 物件，並且我們想要對每個屬性進行迴圈，然後將值記錄到主控台。

:::interactive_editor

```js
const fruit = {
  name: 'apple',
  color: 'red',
  price: 0.99
};

for (const prop in fruit) {
  console.log(fruit[prop]);
}
```

:::

`prop` 變數表述該物件的當前屬性。`fruit[prop]` 用於存取每個屬性的值。

在第一次迭代中，`prop` 將是 `name`。在第二次迭代中，`prop` 將是 `color`，依此類推。

記錄到主控台的結果將是 `apple`、`red` 和 `0.99`。

在這第二個範例中，我們有一個巢狀物件，並且我們想要對每個屬性進行迴圈，並將值記錄到主控台。

:::interactive_editor

```js
const person = {
  name: 'John',
  age: 30,
  address: {
    street: '123 Main St',
    city: 'Anytown',
    state: 'CA'
  }
};

for (const prop in person) {
  console.log(person[prop]);
}
```

:::

`address` 屬性本身就是一個物件。`for...in` 迴圈也會遍歷 `person` 物件的屬性，並將整個 `address` 物件記錄到主控台。

以下是在主控台中結果的顯示方式：

```md
John
30
{ street: '123 Main St', city: 'Anytown', state: 'CA' }
```

如果你想要對 `address` 物件的屬性進行迴圈，你可以在第一個 `for...in` 迴圈內巢狀另一個 `for...in` 迴圈。

:::interactive_editor

```js
const person = {
  name: 'John',
  age: 30,
  address: {
    street: '123 Main St',
    city: 'Anytown',
    state: 'CA'
  }
};

function isObject(obj) {
  return typeof obj === 'object' && !Array.isArray(obj) && obj !== null;
}

for (const prop in person) {
  if (isObject(person[prop])) {
    for (const nestedProp in person[prop]) {
      console.log(person[prop][nestedProp]);
    }
  } else {
    console.log(person[prop]);
  }
}
```

:::

在此範例中，我們有一個訂製函式（程式）`isObject`，用來檢查該值是否為物件。

`Array.isArray` 方法用來檢查該值是否為陣列。透過在該方法前放置邏輯非運算子（`!`），我們是在檢查該值是否不是陣列。

我們不能僅使用 `typeof` 等於 `'object'` 的原因是因為在 JavaScript 中，陣列也被視為物件。我們想要將陣列排除在檢查之外。

此外，由於 JavaScript 中一個歷史性的錯誤，`typeof null` 會傳回 `'object'`。所以我們也想從檢查中排除 `null` 值。

如果條件為真，我們會巢狀另一個 `for...in` 迴圈，該迴圈將遍歷巢狀物件的屬性並將值記錄到主控台。

`nestedProp` 變數表述嵌套物件的當前屬性。

以下是在主控台中修改後結果的顯示方式：

```md
"John"
30
"123 Main St"
"Anytown"
"CA"
```

當你需要對物件的屬性進行迴圈時，`for...in` 迴圈非常有用。

不建議使用 `for...in` 迴圈來遍歷陣列的元素。相反地，請使用 `for...of` 迴圈或其他陣列方法，例如 `forEach`、`map`、`filter` 和 `reduce`，你將在未來的課程中學習這些方法。

# --questions--

## --text--

以下 `code` 的輸出結果會是什麼？

```js
const fruit = {
  name: 'apple',
  color: 'red',
  price: 0.99
};

for (const prop in fruit) {
  console.log(fruit[prop]);
}
```

## --answers--

```md
apple
apple
apple
```

### --feedback--

回顧課程開始部分以了解 `for...in` 迴圈的作用。

---

```md
name
color
price
```

### --feedback--

回顧課程開始部分以了解 `for...in` 迴圈的作用。

---

```md
apple
red
0.99
```

---

```md
fruit
fruit
fruit
```

### --feedback--

回顧課程開始部分以了解 `for...in` 迴圈的作用。

## --video-solution--

3

## --text--

為什麼通常不建議使用 `for...in` 迴圈來迭代陣列的元素？

## --answers--

`for...in` 只會迭代陣列方法，而不會迭代元素。

### --feedback--

考慮 `for...in` 可以存取的屬性和索引的型別。

---

`for...in` 會迭代所有可列舉的屬性，包括繼承的屬性和非數字屬性，這可能導致意外的結果。

---

`for...in` 迴圈比其他陣列迭代方法較慢。

### --feedback--

考慮 `for...in` 可以存取的屬性和索引的型別。

---

`for...in` 無法控制代碼具有非數字索引的陣列。

### --feedback--

考慮 `for...in` 可以存取的屬性和索引的型別。

## --video-solution--

2

## --text--

為什麼在巢狀迴圈範例中需要 `isObject` 函式？

## --answers--

要檢查該值是否為字串。

### --feedback--

思考檢查值是否為物件字面量所需的額外檢查。

---

為確保該值既不是陣列也不是 `null`。

---

驗證該值是否為整數。

### --feedback--

思考檢查值是否為物件字面量所需的額外檢查。

---

將值轉換為物件。

### --feedback--

思考檢查值是否為物件字面量所需的額外檢查。

## --video-solution--

2
