---
id: 5e46f8dcac417301a38fb92e
title: 貓和狗影像類別器
challengeType: 10
forumTopicId: 462377
dashedName: cat-and-dog-image-classifier
---

# --description--

你將會<a href="https://colab.research.google.com/github/freeCodeCamp/boilerplate-cat-and-dog-image-classifier/blob/master/fcc_cat_dog.ipynb" target="_blank" rel="noopener noreferrer nofollow">使用 Google Colaboratory 進行此專案</a>。

前往該連結後，請在你的帳戶中或區域的環境中創建該筆記本的副本。當你完成專案並通過該連結中包含的測試後，請在下方提交你的專案連結。如果你提交的是 Google Colaboratory 連結，請確保已開啟「任何擁有連結的人」的連結分享。

我們仍在開發機器學習課程的互動教學內容。目前，你可以完成此認證中的影片挑戰。你也可能需要尋找額外的學習資源，就像在處理真實專案時會做的那樣。

# --instructions--

在這個挑戰中，你將完成程式碼以分類狗和貓的影像。你將使用 TensorFlow 2.0 和 Keras 來創建一個卷積神經網路，該網路能夠至少在 63% 的時間內正確分類貓和狗的影像。（如果你能達到 70% 的準確率，將獲得額外加分！）

部分程式碼已經提供給你，但有些程式碼你必須填寫以完成此挑戰。請閱讀每個文字儲存格中的說明，這樣你就會知道在每個程式碼儲存格中必須做什麼。

第一個程式碼儲存格匯入所需的函式庫。第二個程式碼儲存格下載資料並設定關鍵變數。第三個儲存格是你第一次撰寫自己程式碼的地方。

下載的資料集檔案結構如下（你會注意到測試目錄沒有子目錄且影像沒有標籤）：

```py
cats_and_dogs
|__ train:
    |______ cats: [cat.0.jpg, cat.1.jpg ...]
    |______ dogs: [dog.0.jpg, dog.1.jpg ...]
|__ validation:
    |______ cats: [cat.2000.jpg, cat.2001.jpg ...]
    |______ dogs: [dog.2000.jpg, dog.2001.jpg ...]
|__ test: [1.jpg, 2.jpg ...]
```

如果你願意，可以調整 epochs 和批次大小，但這不是必須的。

以下指示對應特定的儲存格編號，並在儲存格頂部以註解（例如 `# 3`）顯示。

## 儲存格 3

現在輪到你了！正確設定此儲存格中的每個變數。（它們不應該再相等於 `None`。）

為三個影像資料集（train、validation、test）各自創建影像產生器。使用 `ImageDataGenerator` 來讀取／解碼影像並將其轉換為浮點張量。使用 `rescale` 引數（目前不使用其他引數）將張量從 0 到 255 之間的值重新縮放到 0 到 1 之間的值。

對於 `*_data_gen` 變數，使用 `flow_from_directory` 方法。傳入批次大小、目錄、標的大小（`(IMG_HEIGHT, IMG_WIDTH)`）、類別模式，以及其他所需的參數。`test_data_gen` 將會是最棘手的。對於 `test_data_gen`，請確保傳入 `shuffle=False` 到 `flow_from_directory` 方法。這將確保最終的預測結果保持在測試所期望的順序。對於 `test_data_gen`，觀察目錄結構也會很有幫助。


在你執行程式碼之後，輸出應該看起來像這樣：

```py
Found 2000 images belonging to 2 classes.
Found 1000 images belonging to 2 classes.
Found 50 images belonging to 1 class.
```

## 儲存格 4

`plotImages` 函式（程式）將會被使用數次來繪製影像。它接受一個影像陣列和一個機率列表，儘管機率列表是選用的。這段程式碼已經提供給你。如果你正確地創建了 `train_data_gen` 變數，那麼執行這個區塊將會繪製五張隨機的訓練影像。

## 儲存格 5

使用 `ImageDataGenerator` 重新生成 `train_image_generator`。 

由於訓練範例數量較少，因此存在過度擬合的風險。解決此問題的一種方法是透過隨機轉換，從現有的訓練範例中創建更多的訓練資料。

為你的 `ImageDataGenerator` 添加 4-6 個隨機轉換作為引數。確保重新縮放與之前相同。

## 儲存格 6

你不需要對這個儲存格做任何事情。`train_data_gen` 是像之前一樣創建的，但使用了新的 `train_image_generator`。然後，使用不同的變化將同一張圖片繪製五次。

## 儲存格 7

在此儲存格中，為神經網路創建一個輸出類別機率的模型。它應該使用 Keras Sequential 模型。它可能會包含一個由 Conv2D 和 MaxPooling2D 層組成的堆疊，然後在頂部加上一個由 ReLU 作用函式活化的全連接層。

編譯模型時傳入引數以設定優化器和損失。也傳入 `metrics=['accuracy']` 以查看每個訓練週期的訓練和驗證準確率。

## 儲存格 8

在你的 `model` 上使用 `fit` 方法來訓練網路。請確保傳入 `x`、`steps_per_epoch`、`epochs`、`validation_data` 和 `validation_steps` 的引數。

## 儲存格 9

執行此儲存格以視覺化模型的準確度和損失。

## 儲存格 10

現在是時候使用你的模型來預測一張全新影像是貓還是狗。

在此儲存格中，取得每個測試影像（來自 `test_data_gen`）是狗或貓的機率。`probabilities` 應該是一個整數列表。 

呼叫 `plotImages` 函式（程式），並傳入測試影像以及對應每個測試影像的機率。

在你執行該儲存格後，你應該會看到所有 50 張測試影像，每張影像上都會有一個標籤顯示該影像是貓或狗的「確定」百分比。準確率將對應於上方圖表中顯示的準確率（在執行前一個儲存格後）。更多的訓練影像可能會導致更高的準確率。

## 儲存格 11

執行這個最後的儲存格，以查看你是否通過挑戰或需要繼續嘗試。

# --hints--

它應該通過所有 Python 測試。

```js

```

# --solutions--

```py
  # Python challenges don't need solutions,
  # because they would need to be tested against a full working project.
  # Please check our contributing guidelines to learn more.
```
