---
id: 67336956340e8a34fbd5d9f3
title: 什麼是 `requestAnimationFrame()` API，以及如何使用它來設定動畫迴圈？
challengeType: 19
dashedName: what-is-the-requestanimationframe-api-and-how-can-it-be-used-to-set-up-an-animation-loop
---

# --interactive--

在網頁上創建流暢動畫可能很棘手，特別是如果你不確定如何正確處理時間。好消息是，`requestAnimationFrame()` API 讓這件事變得更簡單。 

`requestAnimationFrame()` 是一個方法，允許你在下一次螢幕重繪之前排程動畫的下一個步驟，從而產生流暢且視覺上吸引人的體驗。

下一次螢幕重新整理是指瀏覽器重新整理網頁視覺顯示的時刻。這通常在大多數顯示器上每秒發生多次，約為 60 次（或每秒 60 個影格）。

要使用 `requestAnimationFrame()` 方法，你只需要呼叫它並傳入一個回呼函式（程式）：

```js
requestAnimationFrame(callback);
```

呼叫 `requestAnimationFrame()` 必須先在控制動畫的函式（例如 `animate()`）內發生，並且搭配一個用來更新動畫的函式，傳統上稱為 `update()`：

```js
function animate() {
 // Update the animation...
 // for example, move an element, change a style, and more.
 update();
 // Request the next frame
 requestAnimationFrame(animate);
}
```

`update()` 函式（程式）是魔法發生的地方。在裡面，你可以更改任何你想要動畫化的內容。 例如，更新樣式或更改元素的位置：

```js
function update() {
 element.style.transform = `translateX(${position}px)`;
 position += 2;
}
```

最終啟動動畫的是呼叫 `requestAnimationFrame()` 並傳入 `animate` 函式（程式），這次是在 `animate` 函式（程式）外部：

```js
requestAnimationFrame(animate);
```

迴圈會持續執行直到你停止它。

現在，讓我們來看看另一個範例。這個範例的 HTML 是一個帶有文字 `freeCodeCamp is Awesome` 的 `div` 元素。CSS 使這個 `div` 成為一個矩形，並隱藏任何超出視窗左側或右側的部分。JavaScript 程式碼在每次以 `animate` 函式作為回呼呼叫 `requestAnimationFrame(animate)` 時，將矩形向右移動 `2px`：

:::interactive_editor

```html
<link rel="stylesheet" href="styles.css" />
<div id="rect" class="rect">freeCodeCamp is Awesome</div>
<script src="index.js"></script>
```

```css
body {
  overflow-x: hidden;
}

.rect {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 400px;
  height: 250px;
  border-radius: 5px;
  background-color: #1b1b32;
  color: #f5f6f7;
  font-size: 2rem;
  position: absolute;
}
```

```js
const rect = document.getElementById("rect");

let position = 0;

function update() {
  // Move the rectangle 2px to the right
  rect.style.left = position + "px";
  position += 2;

  if (position > window.innerWidth) {
    // Move the rectangle just outside the left side of the screen
    position = -rect.offsetWidth;
  }
}

function animate() {
  update();

  //request the next frame
  requestAnimationFrame(animate);
}

// Start the animation
requestAnimationFrame(animate);
```

:::

瀏覽器中的結果將會是一個在螢幕上漂浮的動畫標題卡。

# --questions--

## --text--

`requestAnimationFrame()` 方法做什麼？

## --answers--

它會停止動畫的執行。

### --feedback--

思考這個方法如何幫助創建流暢的動畫。

---

它會立即執行動畫，沒有延遲。

### --feedback--

思考這個方法如何幫助創建流暢的動畫。

---

它加快了動畫速度。

### --feedback--

思考這個方法如何幫助創建流暢的動畫。

---

它會在下一次螢幕重繪之前排程動畫的下一個步驟，以達到更流暢的視覺效果。

## --video-solution--

4

## --text--

使用 `requestAnimationFrame()` 時，什麼會啟動動畫？

## --answers--

在 `requestAnimationFrame()` 方法內呼叫 `animate` 函式（程式）。

### --feedback--

思考 `requestAnimationFrame()` 方法如何觸發動畫。

---

使用 `setTimeout()` 設定逾時。

### --feedback--

思考 `requestAnimationFrame()` 方法如何觸發動畫。

---

使用 `setInterval()` 重複動畫。

### --feedback--

思考 `requestAnimationFrame()` 方法如何觸發動畫。

---

在 animate 函式外呼叫 `requestAnimationFrame()` 並傳入 animate 函式。

## --video-solution--

4

## --text--

「下一次螢幕重繪」是什麼意思？

## --answers--

瀏覽器更新 HTML 結構的時刻。

### --feedback--

思考瀏覽器多久更新你在螢幕上看到的內容。

---

瀏覽器重新整理網頁視覺顯示的時刻，通常約為每秒 60 次。

---

瀏覽器重新載入整個頁面的時刻。

### --feedback--

思考瀏覽器多久更新你在螢幕上看到的內容。

---

瀏覽器更新 CSS 樣式的時刻。

### --feedback--

思考瀏覽器多久更新你在螢幕上看到的內容。

## --video-solution--

2
