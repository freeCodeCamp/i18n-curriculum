---
id: 688c9c4fe5fef91262f9bdf8
title: 什么是 `raise` 语句及其工作原理？
challengeType: 19
dashedName: what-is-the-raise-statement-and-how-does-it-work
---

# --description--

在 Python 中，`raise` 语句是一个强大的工具，允许你在代码中手动触发异常。它使你能够控制错误何时以及如何生成，从而创建自定义误差条件并强制特定的程序行为。

`raise` 语句用于在你的程序中的任何点显式抛出异常，允许你发出发生了误差条件或某些要求未满足的信号。

Python 的 `raise` 语句可以通过多种方式触发异常。最基本的是，你可以引起内置异常或创建自定义错误信息。下面是一个简单的例子：

```py
def check_age(age):
    if age < 0:
        raise ValueError('Age cannot be negative')
    return age

try:
    check_age(-5)
except ValueError as e:
    print(f'Error: {e}') # Error: Age cannot be negative
```

你可以看到这里 `raise` 是触发器异常的关键字。

在此示例中，当提供无效年龄时，我们将引发带有自定义消息的 `ValueError`。

`raise` 语句也可以用来重新引起当前的异常，这在异常处理中尤其有用：

```py
def process_data(data):
    try:
        result = int(data)
        return result * 2
    except ValueError:
        print('Logging: Invalid data received')
        raise  # Re-raises the same ValueError

try:
    process_data('abc')
except ValueError:
    print('Handled at higher level')
```

这里关键字 `raise`（无参数）会重新引发当前正在被处理的异常。

这允许你记录日志或执行清理，同时仍将误差向上传播到调用栈。

你可以通过定义你自己的异常类来创建并引起自定义异常：

```py
class InsufficientFundsError(Exception):
    def __init__(self, balance, amount):
        self.balance = balance
        self.amount = amount
        super().__init__(f'Insufficient funds: ${balance} available, ${amount} requested')

def withdraw(balance, amount):
    if amount > balance:
        raise InsufficientFundsError(balance, amount)
    return balance - amount

try:
    new_balance = withdraw(100, 150)
except InsufficientFundsError as e:
    print(f'Transaction failed: {e}')
```

这里你可以看到自定义异常类继承自 `Exception` 或其子类。 

你将在以后的课程中学习更多关于类和继承的内容。现在，知道这是一种使用自定义逻辑创建你自己的异常的方法即可。

`raise` 语句也可以与 `from` 关键字一起使用，以链接异常，显示不同误差之间的关系：

```py
def parse_config(filename):
    try:
        with open(filename, 'r') as file:
            data = file.read()
            return int(data)
    except FileNotFoundError:
        raise ValueError('Configuration file is missing') from None
    except ValueError as e:
        raise ValueError('Invalid configuration format') from e

config = parse_config('config.txt')
```

这里你可以看到 `raise ... from None` 抑制了原始异常上下文：

```bash
Traceback (most recent call last):
  File "main.py", line 12, in <module>
    config = parse_config('config.txt')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "main.py", line 7, in parse_config
    raise ValueError('Configuration file is missing') from None
ValueError: Configuration file is missing
```

而且 `raise ... from e` 会将新建异常链接到原始异常，保留误差轨迹。

```bash
Traceback (most recent call last):
  File "main.py", line 5, in parse_config
    return int(data)
           ^^^^^^^^^
ValueError: invalid literal for int() with base 10: ''

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "main.py", line 12, in <module>
    config = parse_config('config.txt')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "main.py", line 9, in parse_config
    raise ValueError('Invalid configuration format') from e
ValueError: Invalid configuration format
```

你也可以使用 `assert` 语句有条件地引起异常，这本质上是 `raise` 搭配 `AssertionError` 的简写：

```py
def calculate_square_root(number):
    assert number >= 0, 'Cannot calculate square root of negative number'
    return number ** 0.5

try:
    result = calculate_square_root(-4)
except AssertionError as e:
    print(f'Assertion failed: {e}')
```

`raise` 语句对于创建健壮的应用至关重要，当你需要迫使业务规则、验证输入并提供有意义的错误信息时尤为重要。通过有策略地使用 `raise`，你可以使你的代码更可预测且更易于调试，同时为用户提供清晰的反馈，说明出了什么问题。

# --questions--

## --text--

Python 中的 `raise` 语句有什么作用？

## --answers--

它捕获异常。

### --feedback--

请回到关于抛出异常的章节参照。 

---

它手动触发一个异常。

---

它忽略误差。

### --feedback--

请回到关于抛出异常的章节参照。

---

它修复损坏的代码。

### --feedback--

请回到关于抛出异常的章节参照。

## --video-solution--

2

## --text--

当你使用 `raise` 而不带任何参数时，会发生什么？

## --answers--

它引起一个通用的 `Exception`。

### --feedback--

回到关于 `raise` 的章节，了解它在没有参数时的行为。

---

它什么也不做。

### --feedback--

回到关于 `raise` 的章节，了解它在没有参数时的行为。

---

它重新引起当前的异常。

---

它引起一个 `TypeError`。

### --feedback--

回到关于 `raise` 的章节，了解它在没有参数时的行为。

## --video-solution--

3

## --text--

哪个关键字用于将异常链接在一起？

## --answers--

`with`

### --feedback--

回到关于 `raise` 的章节，了解哪个关键字连接异常。

---

`from`

---

`chain`

### --feedback--

回到关于 `raise` 的章节，了解哪个关键字连接异常。

---

`link`

### --feedback--

回到关于 `raise` 的章节，了解哪个关键字连接异常。

## --video-solution--

2
