---
id: 6733d852175df50937f06061
title: 你如何使用媒体流从局部设备捕捉视频和音频？
challengeType: 19
dashedName: how-can-you-work-with-the-media-streams-getusermedia-to-capture-video-and-audio-from-a-local-device
---

# --description--

有时你可能想捕捉音频或视频，而不是播放音频和视频。Media Capture and Streams API，或称 MediaStream API，允许你这样做。

然而，为了使用该 API，你需要创建 `MediaStream` 对象。你可以使用构造函数来完成，但它不会绑定到用户的硬件。相反，全局的 `navigator` 对象的 `mediaDevices` 属性有一个供你使用的 `getUserMedia()` 方法。

此方法接受一个单一的 `constraints` 对象，该对象定义了你想接收的媒体类型。该对象具有 `audio` 和 `video` 属性，分别对应音频和视频流。如果你不想接收该类型的流，这些属性可以是 `false`，如果想接收，则为 `true`，或者是定义了额外约束的对象。

例如，你可以要求特定分辨率的视频输出：

```js
window.navigator.mediaDevices.getUserMedia({
  audio: true,
  video: {
    width: {
      min: 1280,
      ideal: 1920,
      max: 3840
    },
    height: {
      min: 720,
      ideal: 1080,
      max: 2160
    }
  }
});
```

此约束对象指定视频流的最小和最大分辨率。`ideal` 属性指定你最希望拥有的分辨率——流将提供最接近你理想分辨率的分辨率。

一旦你创建了你的 `MediaStream`（假设用户批准了自动 `request` 访问他们的 `hardware`），你就可以根据需要使用该 `stream` 数据。

请注意，`getUserMedia()` 返回一个 Promise，这意味着你要么需要一个回调函数来使用该流，要么使用异步的 async/await 语法。你将在后续课程中学习更多关于 Promise 和异步的编程知识。 

这是一个基本示例，将用户的摄像头视频流渲染到页面上。

```js
const video = document.querySelector("video");
const stream =
  await window.navigator.mediaDevices.getUserMedia({ video: true });
video.srcObject = stream;
await video.play();
```

值得注意的是，该 API 不提供对 `screen capture` 的访问。你将在下一课中学习该 API。

# --questions--

## --text--

使用哪个方法来访问用户的媒体设备？

## --answers--

`createMediaStream()`

### --feedback--

此方法访问用户的媒体设备。

---

`getMediaDevices()`

### --feedback--

此方法访问用户的媒体设备。

---

`getUserMedia()`

---

`captureStream()`

### --feedback--

此方法访问用户的媒体设备。

## --video-solution--

3

## --text--

在 `video` 的约束对象中，`ideal` 属性表现什么？

## --answers--

最低可接受分辨率。

### --feedback--

思考一下单词 ideal 的含义。

---

最大可能分辨率。

### --feedback--

思考一下单词 ideal 的含义。

---

首选分辨率。

---

如果没有满足其他约束，则使用默认分辨率。

### --feedback--

思考一下单词 ideal 的含义。

## --video-solution--

3

## --text--

`getUserMedia()` 方法返回什么？

## --answers--

一个 `MediaStream` 对象。

### --feedback--

`getUserMedia()` 方法是异步的。

---

一个 `constraints` 对象。

### --feedback--

`getUserMedia()` 方法是异步的。

---

一个 Promise。

---

一个 `video` 元素。

### --feedback--

`getUserMedia()` 方法是异步的。

## --video-solution--

3
