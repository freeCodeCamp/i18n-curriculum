---
id: 6882915386c73273ac489f38
title: 开发 Git 分支策略的一些最佳实践是什么？
challengeType: 19
dashedName: what-are-some-best-practices-for-developing-a-git-branching-strategy
---

# --description--

我们在之前的课程中稍微谈过一些关于分支的内容。你已经学会了如何创建分支，为什么不应该直接向 `main` 提交，等等。但你到底应该什么时候以及为什么创建分支？

首先，让我们谈谈为什么你不应该只是向 `main` 推送一堆提交。你的默认分支应该始终保持稳定——也就是说，在任何时候我都应该能够拉取你当前的 `main` 分支并构建、运行和测试你的应用。如果你推送了部分完成的特色或正在进行中的提交，那么这可能并不总是成立。

此外，同时处理多个特色是非常常见的。如果你同时将多个特色的部分工作推送到 `main`，调试潜在错误会变得更加困难，因为你没有独立的更改。除此之外，上下文切换（或更改你正在处理的任务）也远不如干净。

那么你应该什么时候创建分支？一个通用的经验法则是为每个独立的工作单元创建一个分支。也就是说，如果你正在开发一个新的 OAuth 特色，该工作应在一个专用的分支上进行。如果你随后需要修复密码认证中的错误，该工作应在其自己的专用分支上进行。需要重新设计用户评测页面？那就是另一个分支。

请注意，你应该始终从 `main` 创建你的分支。因此，如果你正在为你的 OAuth 特色工作，你应在为密码认证修复创建新分支之前先检出 `main`。否则，如果你直接从你的 OAuth 分支创建密码修复分支，你将会带上 OAuth 工作的提交，历史记录将变得混乱。

但是你应该如何命名你的分支？这完全取决于你（或你正在贡献的项目），但这里有一些常见的命名规范：

`scope/description` - 其中 `scope` 是类似 `feat` 或 `fix` 的内容，`description` 是对分支更改的简短说明。例如：`feat/oauth-support`。

`scope/issue/description` - 类似于之前的约定，但包括与关联问题相关的编号。例如：`fix/25/password-auth`。

`username/scope/description` - 对于你们所有人都在原始仓库的分支上工作而不是分叉它的项目（这在私有内部仓库中很常见），在分支开头包含你的用户名可能会很有帮助。例如：`naomi-lgbt/feat/profile-redesign`。

让我们介绍一些关于分支策略的其他注意事项。

对于长期存在的特色工作，例如需要大量开发时间的测试版特色，你可能想使用特色标记来选择性地启用逻辑，而不是使用分支。分支存在时间越长，遇到冲突的可能性就越大。

但是，你可能希望为部署环境或版本维护专用的分支。例如，freeCodeCamp 仓库使用 `prod-staging` 和 `prod-current` 分别触发到预发布和生产服务器的部署。这可以让团队更快地迭代，在准备好并获得批准后合并，而无需为每次合并触发部署。相反，部署是通过将最新的 `main` 合并到那些生产分支来创建的。

你可能还想维护“release branches”，或者表现你产品主要版本的分支。这允许你为每个主要版本保持一个干净的状态，因此如果你需要将关键的安全性补丁回端口到较早的版本，你可以做到而无需包含任何新版本的更改。

最后，你应避免使用局部的 CLI 将你的分支合并到 `main`。相反，应创建一个包含你更改的拉取请求，并通过该流程进行合并。这让你有机会确保任何测试在你的 CI 中通过（你将在未来的课程中学习 CI），并且可以再次查看差异视图，以确保你只包含了想要合并的更改。

有了这些技巧，你就可以开始通过分支走向成功！

# --questions--

## --text--

为什么你应该避免直接向 `main` 分支提交？

## --answers--

因为 Git 不允许直接向 `main` 提交。

### --feedback--

考虑默认分支的稳定性和可靠性要求。

---

因为 `main` 分支应始终保持可靠稳定。

---

因为对 `main` 的提交是永久锁定的，且无法更改。

### --feedback--

考虑默认分支的稳定性和可靠性要求。

---

因为 `main` 分支的性能比特色分支更慢。

### --feedback--

考虑默认分支的稳定性和可靠性要求。

## --video-solution--

2

## --text--

创建 `new branch` 时，以下哪项是最佳实践？

## --answers--

从你当前的特色分支创建新建分支。

### --feedback--

考虑保持分支历史清晰并避免意外包含代码。

---

始终从 `main` 创建新建分支。

---

只为主要特色创建分支。

### --feedback--

考虑保持分支历史清晰并避免意外包含代码。

---

每周限制自己只使用一个分支。

### --feedback--

考虑保持分支历史清晰并避免意外包含代码。

## --video-solution--

2

## --text--

处理长期存在的 `feature` 工作的推荐方法是什么？

## --answers--

创建一个包含所有相关工作的巨大分支。

### --feedback--

考虑长期未合并的分支可能导致的合并冲突。

---

使用特色标记而不是长期存在的分支。

---

始终使用局部的 CLI 直接合并到 `main`。

### --feedback--

考虑长期未合并的分支可能导致的合并冲突。

---

为每个主要 `feature` 创建一个新建的仓库。

### --feedback--

考虑长期未合并的分支可能导致的合并冲突。

## --video-solution--

2
