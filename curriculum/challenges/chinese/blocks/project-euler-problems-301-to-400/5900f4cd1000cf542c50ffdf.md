---
id: 5900f4cd1000cf542c50ffdf
title: '问题 352：血液检测'
challengeType: 1
forumTopicId: 302012
dashedName: problem-352-blood-tests
---

# --description--

必须对一群羊中的25只绵羊中的每一只进行稀有病毒检测，已知这种病毒会影响2％的绵羊群体。

对血液样品存在准确且极其灵敏的PCR测试，产生明显的阳性/阴性结果，但是它非常耗时且昂贵。

由于成本高，主管兽医建议不执行 25 个单独的测试，而是可以使用以下过程：

这些羊被分成 5 组，每组 5 只羊。对于每组，将 5 个样本混合在一起并执行单次测试。然后，

- 如果结果为负，则该组中的所有羊都被视为无病毒。
- 如果结果为阳性，将进行5次额外测试（对每只动物进行单独测试）以确定受影响的个体。

由于任何特定动物的感染概率仅为 0.02，每组的第一次测试（在池样本上）将是：

- 阴性（且无需更多测试），概率为 ${0.98}^5 = 0.9039207968$。
- 阳性（需要 5 个额外测试），概率为 $1 - 0.9039207968 = 0.0960792032$。

因此，每组的预期测试数量为 $1 + 0.0960792032 × 5 = 1.480396016$。

因此，所有 5 个组只需使用平均 $1.480396016 × 5 = \mathbf{7.40198008}$ 次测试即可筛选完成，这表现出超过 70% 的巨大节省！

虽然我们刚刚描述的方案看起来非常高效，但它仍然可以大幅改进（前提是测试足够灵敏且混合不同样本不会引起不良效果）。例如：

- We may start by running a test on a mixture of all the 25 samples. 可以证实，在大约60.35％的情况下，该测试将是否定的，因此不再需要进行测试。 其余39.65％的案件只需要进一步测试。
- 如果我们知道5个一组中至少有一只动物被感染并且前4个个体测试结果为阴性，则不需要对第五个动物进行测试（我们知道它必须被感染）。
- 我们可以在每组中尝试不同数量的组/不同数量的动物，在每个级别调整这些数字，以便最小化测试的总预期数量。

对于当前的例子，事实证明，最具成本效益的测试方案（我们称之为最优策略）需要平均只需4.155452次测试！

对于当前示例，事实证明最具成本效益的测试方案（我们称之为最优策略）平均只需要 <strong>4.155452</strong> 次测试！

使用最优策略，令 $T(s, p)$ 表现为筛查一群 $s$ 只羊中病毒的平均测试次数，病毒在任一只羊体内出现的概率为 $p$。因此，四舍五入到小数点后六位，$T(25, 0.02) = 4.155452$ 和 $T(25, 0.10) = 12.702124$。

查找 $\sum T(10\,000, p)$，其中 $p = 0.01, 0.02, 0.03, \ldots 0.50$。将你的答案四舍五入到六位小数。

# --hints--

`bloodTests()` 应该返回 `378563.260589`。

```js
assert.strictEqual(bloodTests(), 378563.260589);
```

# --seed--

## --seed-contents--

```js
function bloodTests() {

  return true;
}

bloodTests();
```

# --solutions--

```js
// solution required
```
