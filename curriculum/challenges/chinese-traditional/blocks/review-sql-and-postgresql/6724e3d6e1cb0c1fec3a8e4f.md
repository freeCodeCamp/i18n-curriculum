---
id: 6724e3d6e1cb0c1fec3a8e4f
title: SQL 和 PostgreSQL 回顧
challengeType: 31
dashedName: review-sql-and-postgresql
---

# --description--

## 關聯式資料庫簡介

- **關聯式資料庫**：將資料組織成由列和行組成的相關表格。每列表述一筆記錄，每行表述資料的一個屬性。
- **關聯式資料庫的優點**：可擴充、廣泛適用於各領域（例如，醫療、商務、遊戲），且結構化以維護可靠的資料。
- **常見使用案例**：網頁開發、庫存系統、電子商務、醫療保健和企業應用程式。

## 關鍵概念

- **Schema**：關聯式資料庫需要一個定義其結構—資料表、行、資料型別、條件和關聯的 schema。
- **主鍵**：每個資料表中每列的唯一識別符。它們對資料完整性至關重要，並用於透過外鍵關聯資料表之間的記錄。
- **外鍵**：對另一個資料表中主鍵的引用，用於連結跨資料表的相關資料。
- **關聯**：透過主鍵和外鍵連接資料表，你可以結構化正規化的資料並執行有意義的查詢。
- **物體關聯圖（ERDs）**：視覺化物體（資料表）在資料庫架構中彼此的關聯。
- **資料完整性**：使用鍵和資料型別強制執行。確保儲存資料的一致性和準確性。

## SQL 基礎知識

- **查詢**：從資料庫中擷取特定資料的請求。

```sql
SELECT * FROM dogs WHERE age < 3;
```

- **WHERE 語句**：根據條件篩選結果。使用比較運算子如 `<`、`=`、`>` 等。
- **使用 ORDER BY 選取**：根據行檢索並排序結果。

```sql
SELECT columns FROM table_name ORDER BY column_name;
```

## 表格操作

- **`CREATE TABLE` 述語**：此述語用於在資料庫中創建新資料表。

```sql
CREATE TABLE first_table();
```

- **`ALTER TABLE ADD COLUMN` 述語**：此述語用於為現有資料表添加行。

```sql
ALTER TABLE table_name ADD COLUMN column_name DATATYPE;
```

- **`ALTER TABLE DROP COLUMN` 述語**：此述語用於從現有資料表中刪除一個行。

```sql
ALTER TABLE table_name DROP COLUMN column_name;
```

- **`ALTER TABLE RENAME COLUMN` 述語**：此述語用於重新命名資料表中的行。

```sql
ALTER TABLE table_name RENAME COLUMN column_name TO new_name;
```

- **`DROP TABLE` 述語**：此述語用於從資料庫中刪除整個資料表。

```sql
DROP TABLE table_name;
```

- **`ALTER DATABASE RENAME` 述語**：此述語用於重新命名資料庫。

```sql
ALTER DATABASE database_name RENAME TO new_database_name;
```

- **`DROP DATABASE` 述語**：此述語用於刪除整個資料庫。

```sql
DROP DATABASE database_name;
```

## 條件與資料完整性

- **`ALTER TABLE ADD COLUMN` 搭配條件**：此述語用於為現有資料表添加帶有條件的行。

```sql
ALTER TABLE table_name ADD COLUMN column_name DATATYPE CONSTRAINT;
```

- **`NOT NULL` 條件**：此條件確保行不能有 NULL 值。

```sql
column_name VARCHAR(50) NOT NULL
```

- **`ALTER TABLE ADD PRIMARY KEY` 述語**：此述語用於為資料表添加主鍵條件。

```sql
ALTER TABLE table_name ADD PRIMARY KEY(column_name);
```

- **`ALTER TABLE DROP CONSTRAINT` 述語**：此述語用於從資料表中刪除條件。

```sql
ALTER TABLE table_name DROP CONSTRAINT constraint_name;
```

- **`ALTER TABLE ADD COLUMN` 與外鍵**：此述語用於新增一個外鍵行，該行引用另一個資料表。

```sql
ALTER TABLE table_name ADD COLUMN column_name DATATYPE REFERENCES referenced_table_name(referenced_column_name);
```

- **`ALTER TABLE ADD UNIQUE` 述語**：此述語用於為你的行添加 UNIQUE 條件。

```sql
ALTER TABLE table_name ADD UNIQUE(column_name);
```

- **`ALTER TABLE ALTER COLUMN SET NOT NULL` 述語**：此述語用於在現有的行上設定 NOT NULL 條件。

```sql
ALTER TABLE table_name ALTER COLUMN column_name SET NOT NULL;
```

- **`INSERT` 述語與 NULL 值**：此述語示範如何將 NULL 值插入資料表中。

```sql
INSERT INTO table_name(column_a) VALUES(NULL);
-- or
INSERT INTO table_name(column_b) VALUES('value'); -- if column_a allows nulls
```

- **複合主鍵**：此條件定義由多個行組成的主鍵。

```sql
CREATE TABLE course_enrollments (
    student_id INT,
    course_id INT,
    PRIMARY KEY (student_id, course_id)
);
```

## 資料操作（CRUD）

- **`INSERT` 述語**：此述語用於將單一列插入資料表中。

```sql
INSERT INTO table_name(column_1, column_2) VALUES(value1, value2);
```

- **省略行的 `INSERT` 述語**：此述語示範如何在不明確列出行名稱的情況下插入值，依賴資料表中的預設行順序。

```sql
INSERT INTO dogs VALUES ('Gino', 3);
```

- **多列的 `INSERT` 述語**：此述語用於在單一操作中將多列插入資料表。

```sql
INSERT INTO dogs (name, age) VALUES 
('Gino', 3),
('Nora', 2);
```

- **`UPDATE` 述語**：此述語用於根據條件更新資料表中現有的資料。

```sql
UPDATE table_name SET column_name=new_value WHERE condition;
```

- **`DELETE` 述語**：此述語用於根據條件刪除資料表中的列。

```sql
DELETE FROM table_name WHERE condition;
```

## 資料型別

- **`NUMERIC` 資料型別**：此資料型別用於儲存具有指定精度和小數位數的精確十進位數字。

```sql
price NUMERIC(10, 2)
```

- **`TEXT` 資料型別**：此資料型別用於儲存無特定長度限制的可變長度字元字串。

```sql
column_name TEXT
```

- **`INTEGER` 資料型別**：此資料型別用於儲存沒有小數位的整數。

```sql
units_sold INTEGER
```

- **`SMALLINT` 和 `BIGINT` 資料型別**：這些是 INTEGER 的變體，分別具有較小和較大的範圍。

- **`SERIAL` 資料型別**：此資料型別用於在 PostgreSQL 中創建自動遞增的整數行。

```sql
id SERIAL
```

- **`AUTO_INCREMENT` 屬性**：此屬性用於 MySQL 中以創建自動遞增的整數行。

```sql
id INT AUTO_INCREMENT
```

- **`VARCHAR` 資料型別**：此資料型別用於儲存具有指定最大長度的可變長度字元字串。

```sql
name VARCHAR(50)
```

- **`DATE` 資料型別**：此資料型別用於儲存日期值（年、月、日）。

```sql
event_date DATE
```

- **`TIME` 資料型別**：此資料型別用於儲存時間值（小時、分鐘、秒）。

```sql
start_time TIME
```

- **`TIMESTAMP` 資料型別**：此資料型別用於儲存日期和時間值，並可選擇性地包含時區資訊。

```sql
event_timestamp TIMESTAMP
event_timestamp TIMESTAMP WITH TIME ZONE
```

- **`BOOLEAN` 資料型別**：此資料型別用於儲存 true/false 值。

```sql
is_active BOOLEAN
```

## 資料庫關聯

- **關係的型別**：這些是在關聯式資料庫中資料表彼此關聯的不同方式。
  - 一對一
  - 一對多
  - 多對一
  - 多對多
  - 自我取用（遞迴）

- **一對一關係**：此關係型別表示一個資料表中的每個記錄對應另一個資料表中的恰好一個記錄。

```md
One employee is assigned exactly one vehicle.
Tables: employees, vehicles
```

- **一對多關係**：此關係型別表示一個資料表中的一筆記錄可以與另一個資料表中的多筆相關記錄。

```md
One customer can have many orders.
Tables: customers → orders
```

- **多對多關係透過連接表**：此關係型別是使用包含兩個相關資料表外鍵的連接表來實作。

```sql
CREATE TABLE books_authors (
    author_id INT REFERENCES authors(id),
    book_id INT REFERENCES books(id)
);
```

- **自我取用關係**：當一個資料表取用自身時，會產生階層式結構的關係型態。

```md
An employee table where each employee may report to another employee.
```

## 進階 SQL（連接）

- **`INNER JOIN` 述語**：此連接僅傳回兩個資料表中具有相符值的列。

```sql
SELECT *
FROM products
INNER JOIN sales ON products.product_id = sales.product_id;
```

- **`FULL OUTER JOIN` 述語**：此連接會傳回兩個資料表中的所有列，包括任一資料表中未配對的列。

```sql
SELECT *
FROM products
FULL OUTER JOIN sales ON products.product_id = sales.product_id;
```

- **`LEFT OUTER JOIN` 述語**：此連接會傳回左表的所有列以及右表中符合條件的列。

```sql
SELECT *
FROM products
LEFT JOIN sales ON products.product_id = sales.product_id;
```

- **`RIGHT OUTER JOIN` 述語**：此連接會傳回右表的所有列以及左表中符合條件的列。

```sql
SELECT *
FROM products
RIGHT JOIN sales ON products.product_id = sales.product_id;
```

- **`SELF JOIN` 述語**：此連接用於將資料表與自身連接，以比較同一資料表內的列。

```sql
SELECT A.column_name, B.column_name
FROM table_name A
JOIN table_name B ON A.related_column = B.related_column;
```

- **`CROSS JOIN` 述語**：此連接會傳回兩個資料表的笛卡兒積，將第一個資料表的每一列與第二個資料表的每一列組合。

```sql
SELECT *
FROM table1
CROSS JOIN table2;
```

## PostgreSQL 專用指令

- **`psql` 登入指令**：此指令用於使用特定使用者名稱和資料庫登入 PostgreSQL。

```bash
psql --username=freecodecamp --dbname=postgres
```

- **`\l` 指令**：此指令會列出 PostgreSQL 實體中的所有資料庫。

```sql
\l
```

- **`CREATE DATABASE` 和 `\c` 指令**：這些指令用於創建新的資料庫並連接到該資料庫。

```sql
CREATE DATABASE database_name;
\c database_name
```

- **`\d` 指令**：此指令會列出目前資料庫中的所有資料表。

```sql
\d
```

- **`\d table_name` 指令**：此指令會顯示特定資料表的 schema／結構。

```sql
\d table_name
```

- **`\q` 指令**：此指令會離開 PostgreSQL 客戶端。

```bash
\q
```

## 關聯式與非關聯式

- **非關聯式（NoSQL）資料庫**：儲存非結構化或半結構化資料。不需要嚴格的結構，對於演變中的資料模型更具彈性。
- **選擇關聯式與非關聯式**：取決於你的資料性質和應用需求。
- **關聯式與非關聯式**：為結構化資料和一致性選擇關聯式；為彈性和快速變動的資料選擇 NoSQL。

## 熱門的 RDBMS 系統

- **MySQL**：開放原始碼、可靠、廣泛用於網頁開發，由龐大社群支援。
- **PostgreSQL**：開放原始碼、進階、可擴充。支援訂製資料型別和伺服端程式設計。
- **SQLite**：輕量級、基於檔案、無伺服端。適合小型應用程式。
- **Microsoft SQL Server**：專有的企業級資料庫。
- **Oracle Database**：以大規模效率與可擴充性著稱的商業關聯式資料庫管理系統。

## 最佳實務

- **命名慣例**：對於資料表和行名稱，使用 `snake_case`（例如，`delivery_orders`）。

# --assignment--

檢視 SQL 和 PostgreSQL 主題與概念。
