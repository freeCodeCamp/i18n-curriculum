---
id: 67d30191adb999a9909109ef
title: 什么是泛型，它们如何工作？
challengeType: 19
dashedName: what-are-generics-and-how-do-they-work
---

# --description--

你实际上在之前的课程中见过一个通用的类型：`Array<string>`。但你通常会在函数中使用通用类型。事实上，它们可以被视为你提供给函数的一个特殊参数，用来控制函数类型定义的行为。

让我们回到之前获取数组中随机值的函数示例：

```js
const getRandomValue = (array: string[]): string => {
  return array[Math.floor(Math.random() * array.length)];
}
```

我们的函数接受一个字串数组并返回一个字串。但如果我们想传入一个数字数组并返回一个数字呢？

你可以使用一个并集类型：

```js
const getRandomValue = (array: (string|number)[]): (string|number) => {
  return array[Math.floor(Math.random() * array.length)];
}
const val = getRandomValue([1, 2, 4])
```

但是使用这种方法，即使我们传入的数组中只有数字，TypeScript 仍然判断 `val` 变量可能是数字或字串。

相反，你可以为该函数定义一个通用的类型：

```js
const getRandomValue = <T>(array: T[]): T => {
  return array[Math.floor(Math.random() * array.length)];
}
const val = getRandomValue([1, 2, 4])
```

我们的新示例中有几个重要的组件。首先，`<T>` 语法告诉 TypeScript 你正在为函数定义一个通用的类型 `T`。`T` 是通用类型的常用名称，但你实际上可以根据 JavaScript 的变量规则随意命名。

然后，我们告诉 TypeScript 该数组参数是一个匹配通用类型的值数组，并且返回值是该相同类型的单个元素。这使得 TypeScript 能够正确检测到 `val` 将是一个数字，因为我们传递的数组仅由数字组成。

但是那些你无法控制的函数呢？让我们来看一下 `document.querySelector()` 方法：

```js
const email = document.querySelector("#email");
console.log(email.value);
```

因为我们使用 ID 选择器进行查询，TypeScript 不知道我们查询的是哪种元素。它知道这是某种 `Element`，但我们尝试访问 `value` 属性会抛出误差，因为顶层元素接口没有该属性。

幸运的是，我们可以将类型参数传递给函数调用：

```js
const email = document.querySelector<HTMLInputElement>("#email");
console.log(email.value);
```

注意我们再次使用了尖括弧语法（`<HTMLInputElement>`），但这次是在函数调用中。这告诉 TypeScript 我们期望查找到的元素将是一个 `input` 元素，因此我们在访问 value 属性时不再出现误差，因为 input 元素确实有该属性。当然，如果未找到元素，`querySelector` 可能返回 `null`，而且 TypeScript 会在这里抛出编译器误差，因为我们没有处理该分支。

但你将在下一课中学习到这部分内容。

# --questions--

## --text--

在函数中定义通用类型的正确语法是什么？

## --answers--

```ts
function<T>
```

---

```ts
<T>function
```

### --feedback--

通用的类型使用尖括弧在函数的参数列表之前定义。

---

```ts
(T)function
```

### --feedback--

通用的类型使用尖括弧在函数的参数列表之前定义。

---

```ts
function(T)
```

### --feedback--

通用的类型使用尖括弧在函数的参数列表之前定义。

## --video-solution--

1

## --text--

在以下示例中，`T[]` 表现什么？

```ts
const getRandomValue = <T>(array: T[]): T => { ... }
```

## --answers--

任何类型的数组。

### --feedback--

`T` 后面的方括弧表示该类型的数组。

---

一个通用的 `T` 类型数组。

---

一个类型为 `T` 的元组。

### --feedback--

`T` 后面的方括弧表示该类型的数组。

---

一个类型为 `T` 的单个元素。

### --feedback--

`T` 后面的方括弧表示该类型的数组。

## --video-solution--

2

## --text--

调用 `document.querySelector()` 时，如何指定类型参数？

## --answers--

```js
document.querySelector("#email", HTMLInputElement)
```

### --feedback--

类型参数通过位于函数名和其参数之间的尖括弧传递。

---

```js
document.querySelector("#email"): HTMLInputElement
```

### --feedback--

类型参数通过位于函数名和其参数之间的尖括弧传递。

---

```js
document.querySelector<HTMLInputElement>("#email")
```

---

```js
document.querySelector("#email" as HTMLInputElement)
```

### --feedback--

类型参数通过位于函数名和其参数之间的尖括弧传递。

## --video-solution--

3
