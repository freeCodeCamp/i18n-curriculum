---
id: 5900f4cd1000cf542c50ffdf
title: '問題 352：血液檢查'
challengeType: 1
forumTopicId: 302012
dashedName: problem-352-blood-tests
---

# --description--

必須對羊群中 25 隻羊的每一隻進行罕見病毒的檢測，該病毒已知會影響 2％ 的羊隻族群。

存在一種針對血液樣本的準確且極為敏感的 PCR 測試，能產生明確的陽性／陰性結果，但它非常耗時且昂貴。

因為成本很高，負責的獸醫建議與其執行 25 個獨立測試，不如改用以下程序：

這些羊被分成 5 個群組，每個群組有 5 隻羊。對每個群組，將 5 個樣本混合在一起並進行一次測試。然後，

- 如果結果為負值，該群組中所有的羊都被視為無病毒。
- 如果結果為陽性，將進行 5 次額外測試（針對每隻動物進行單獨測試）以確定受影響的個體。

由於任何特定動物的感染機率僅為 0.02，每個群組的第一次測試（對合併樣本進行）將會是：

- 陰性（且不需要更多測試），機率為 ${0.98}^5 = 0.9039207968$。
- 陽性（需要額外 5 次測試）機率為 $1 - 0.9039207968 = 0.0960792032$。

因此，每個群組的預期測試數為 $1 + 0.0960792032 × 5 = 1.480396016$。

因此，所有 5 個群組只需使用平均 $1.480396016 × 5 = \mathbf{7.40198008}$ 次測試，即可完成篩選，這代表節省超過 70% 的大量成本！

雖然我們剛剛描述的結構綱目似乎非常高效，但它仍然可以大幅改進（前提是測試足夠敏感且混合不同樣本不會造成不良影響）。例如：

- 我們可能會先對所有 25 個樣本的混合物進行測試。可以驗證約有 60.35％ 的情況下此測試結果為陰性，因此不需要進行更多測試。只有在剩餘的 39.65％ 情況下才需要進一步測試。
- 如果我們知道在 5 隻動物的群組中至少有一隻被感染，而前 4 次個別測試結果為陰性，則不需要對第五隻動物進行測試（我們知道它一定被感染）。
- 我們可以嘗試不同數量的群組／每個群組中不同數量的動物，並在每個層次調整這些數字，以使預期的總測試數量達到最小化。

為了簡化非常廣泛的可能性範圍，我們在設計最具成本效益的測試結構綱目時設定了一項限制：每當我們從混合樣本開始時，所有對該樣本有貢獻的羊隻必須先全部接受篩檢（即必須對牠們全部達成感染／無病毒的判定），然後才能開始檢查其他動物。

對於目前的範例，結果顯示最具成本效益的測試結構綱目（我們稱之為最佳策略）平均只需要 <strong>4.155452</strong> 次測試！

使用最佳策略，令 $T(s, p)$ 表述篩檢一群有 $s$ 隻羊的平均測試次數，該病毒在任何個體中存在的機率為 $p$。因此，四捨五入到小數點後六位，$T(25, 0.02) = 4.155452$ 和 $T(25, 0.10) = 12.702124$。

找出 $\sum T(10\,000, p)$，其中 $p = 0.01, 0.02, 0.03, \ldots 0.50$。將你的答案四捨五入到六位小數。

# --hints--

`bloodTests()` 應該傳回 `378563.260589`。

```js
assert.strictEqual(bloodTests(), 378563.260589);
```

# --seed--

## --seed-contents--

```js
function bloodTests() {

  return true;
}

bloodTests();
```

# --solutions--

```js
// solution required
```
