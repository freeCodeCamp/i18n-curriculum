---
id: 688c9c4fe5fef91262f9bdf8
title: 什麼是 `raise` 述語 以及它如何運作？
challengeType: 19
dashedName: what-is-the-raise-statement-and-how-does-it-work
---

# --description--

在 Python 中，`raise` 述語是一個強大的工具，允許你在你的程式碼中手動觸發例外。它讓你控制錯誤產生的時間和方式，使你能夠創建訂製的錯誤條件並強制執行特定的程式行為。

`raise` 述語用於在你的程式中任何點明確地丟出例外，讓你能夠發出錯誤狀況已發生或某些需求尚未達成的信號。

Python 的 `raise` 述語可以用多種方式來觸發例外。在最基本的情況下，你可以引發內建例外或創建訂製錯誤訊息。以下是一個簡單的範例：

```py
def check_age(age):
    if age < 0:
        raise ValueError('Age cannot be negative')
    return age

try:
    check_age(-5)
except ValueError as e:
    print(f'Error: {e}') # Error: Age cannot be negative
```

你可以看到這裡 `raise` 是觸發例外的關鍵字。

在此範例中，當提供無效年齡時，我們會引發帶有訂製訊息的 `ValueError`。

`raise` 述語也可以用來重新引發目前的例外，這在例外處理中特別有用：

```py
def process_data(data):
    try:
        result = int(data)
        return result * 2
    except ValueError:
        print('Logging: Invalid data received')
        raise  # Re-raises the same ValueError

try:
    process_data('abc')
except ValueError:
    print('Handled at higher level')
```

這裡關鍵字 `raise`（無引數）會重新引發目前正在被控制代碼的例外。

這讓你能夠記錄或執行清理，同時仍將錯誤向上傳播至呼叫堆疊。

你可以透過定義你自己的例外類別來創建並引發訂製例外：

```py
class InsufficientFundsError(Exception):
    def __init__(self, balance, amount):
        self.balance = balance
        self.amount = amount
        super().__init__(f'Insufficient funds: ${balance} available, ${amount} requested')

def withdraw(balance, amount):
    if amount > balance:
        raise InsufficientFundsError(balance, amount)
    return balance - amount

try:
    new_balance = withdraw(100, 150)
except InsufficientFundsError as e:
    print(f'Transaction failed: {e}')
```

在這裡你可以看到訂製例外類別繼承自 `Exception` 或其子類別。 

你將在未來的課程中學習更多關於類別和繼承的內容。現在，請知道這是一種使用訂製邏輯來創建你自己的例外的方法。

`raise` 述語也可以與 `from` 字一起使用，以串鏈例外，顯示不同錯誤之間的關係：

```py
def parse_config(filename):
    try:
        with open(filename, 'r') as file:
            data = file.read()
            return int(data)
    except FileNotFoundError:
        raise ValueError('Configuration file is missing') from None
    except ValueError as e:
        raise ValueError('Invalid configuration format') from e

config = parse_config('config.txt')
```

在這裡你可以看到 `raise ... from None`，會抑制原始的例外背景關係。

```bash
Traceback (most recent call last):
  File "main.py", line 12, in <module>
    config = parse_config('config.txt')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "main.py", line 7, in parse_config
    raise ValueError('Configuration file is missing') from None
ValueError: Configuration file is missing
```

而 `raise ... from e`，會將新的例外串鏈到原始例外，保留錯誤軌跡。

```bash
Traceback (most recent call last):
  File "main.py", line 5, in parse_config
    return int(data)
           ^^^^^^^^^
ValueError: invalid literal for int() with base 10: ''

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "main.py", line 12, in <module>
    config = parse_config('config.txt')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "main.py", line 9, in parse_config
    raise ValueError('Invalid configuration format') from e
ValueError: Invalid configuration format
```

你也可以使用 `assert` 述語有條件地引發例外，這本質上是 `raise` 搭配 `AssertionError` 的簡寫：

```py
def calculate_square_root(number):
    assert number >= 0, 'Cannot calculate square root of negative number'
    return number ** 0.5

try:
    result = calculate_square_root(-4)
except AssertionError as e:
    print(f'Assertion failed: {e}')
```

`raise` 述語對於建立強固的應用程式至關重要，當你需要強制執行商務規則、驗證輸入並提供有意義的錯誤訊息時尤其如此。透過策略性地使用 `raise`，你可以讓你的程式碼更具可預測性且更容易偵錯，同時給使用者清楚的回授，說明發生了什麼錯誤。

# --questions--

## --text--

`raise` 述語在 Python 中的作用是什麼？

## --answers--

它捕捉例外。

### --feedback--

請回到關於引發例外的章節取用。 

---

它會手動觸發一個例外。

---

它會忽略錯誤。

### --feedback--

請回到關於引發例外的章節取用。

---

它修復損壞的程式碼。

### --feedback--

請回到關於引發例外的章節取用。

## --video-solution--

2

## --text--

當你使用 `raise` 而不帶任何引數時會發生什麼？

## --answers--

它會引發一個泛型的 `Exception`。

### --feedback--

請回到關於 `raise` 的章節，了解它在沒有引數時的行為。

---

它不會執行任何操作。

### --feedback--

請回到關於 `raise` 的章節，了解它在沒有引數時的行為。

---

它會重新引發目前的例外。

---

它會引發 `TypeError`。

### --feedback--

請回到關於 `raise` 的章節，了解它在沒有引數時的行為。

## --video-solution--

3

## --text--

哪個關鍵字用來串鏈例外？

## --answers--

`with`

### --feedback--

請回到關於 `raise` 的章節，以了解哪個關鍵字連接例外。

---

`from`

---

`chain`

### --feedback--

請回到關於 `raise` 的章節，以了解哪個關鍵字連接例外。

---

`link`

### --feedback--

請回到關於 `raise` 的章節，以了解哪個關鍵字連接例外。

## --video-solution--

2
