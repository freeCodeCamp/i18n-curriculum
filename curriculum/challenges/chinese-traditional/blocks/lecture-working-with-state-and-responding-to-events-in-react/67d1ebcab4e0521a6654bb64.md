---
id: 67d1ebcab4e0521a6654bb64
title: 你如何更新狀態中的陣列？
challengeType: 19
dashedName: how-do-you-update-arrays-in-state
---

# --description--

在 React 中，更新狀態中的陣列相當簡單，但如果你來自可以直接修改陣列的純 JavaScript，則很容易犯錯。

在 React 中，state 被視為不可變的，因此它可以識別變更並對使用者介面進行適當的更新。

讓我們來看看你如何更新 React 狀態中保存的陣列。

在 React 狀態中更新陣列時，最常見的錯誤之一是直接使用像 `push()`、`pop()` 或 `splice()` 這些方法來修改陣列。這些方法會變更原始陣列，而 React 不允許這樣做。

React 依賴新的陣列引用來偵測變更，所以直接修改陣列可能會阻止組件如預期般重新呈現。

以下是使用 `push()` 方法為狀態中的陣列添加元素的範例，但這樣做不會成功：

```jsx
import { useState } from "react";

function ItemsList() {
  const [items, setItems] = useState([
    { id: 0, name: "Item 1" },
    { id: 1, name: "Item 2" },
    { id: 2, name: "Item 3" },
  ]);

  const addItem = () => {
    const newItem = { id: items.length + 1, name: `Item ${items.length + 1}` };
    items.push(newItem); // This modifies the original array
    setItems(items); // React will not detect this change
  };

  return (
    <div>
      <button onClick={addItem}>Add Item</button>
      <ul>
        {items.map((item) => (
          <li key={item.id}>{item.name}</li>
        ))}
      </ul>
    </div>
  );
}

export default ItemsList;
```

如果你點擊 `Add Item` 按鈕，使用者介面中不會有任何反應。

你可能也會想用 `pop()` 方法從陣列中移除項目：

```js
const removeItem = () => {
  items.pop(); // Modifies the original array
  setItems(items); // React will not detect this change, either
};
```

要更新狀態中的陣列，關鍵是創建一個新的陣列，執行你的操作行為，然後將其傳遞給 React，而不是變更現有的陣列。

因為它是新的陣列，React 會知道狀態已經改變，並觸發重新呈現。

以下是如何使用展開運算子將項目添加到 `items` 陣列的方法：

```js
const addItem = () => {
  const newItem = {
    id: items.length + 1,
    name: `Item ${items.length + 1}`,
  };

  // Creates a new array
  setItems((prevItems) => [...prevItems, newItem]);
};
```

`[...prevItems, newItem]` 透過複製狀態中現有 `items` 陣列的所有條款來創建一個新的陣列，然後在末尾添加 `newItem`，這會遞增 `id` 和條款編號。

如果你想從陣列中移除某些東西，你可以使用 `filter()` 方法，該方法會在過濾掉你想移除的項目後傳回一個新的陣列：

```js
const removeItem = (id) => {
  setItems((prevItems) => prevItems.filter((item) => item.id !== id));
};
```

以下是完整的程式碼：

```jsx
import { useState } from "react";

function ItemsList() {
  const [items, setItems] = useState([
    { id: 0, name: "Item 1" },
    { id: 1, name: "Item 2" },
    { id: 2, name: "Item 3" },
  ]);

  const addItem = () => {
    const newItem = { id: items.length + 1, name: `Item ${items.length + 1}` };
    setItems((prevItems) => [...prevItems, newItem]); // Creates a new array
  };

  const removeItem = (id) => {
    setItems((prevItems) => prevItems.filter((item) => item.id !== id)); // Creates a new array
  };

  return (
    <div>
      <button onClick={addItem}>Add Item</button>
      <ul>
        {items.map((item) => (
          <li key={item.id}>
            {item.name}{" "}
            <button onClick={() => removeItem(item.id)}>Remove</button>
          </li>
        ))}
      </ul>
    </div>
  );
}

export default ItemsList;
```

這些是在狀態中更新陣列的一些常見方法。

# --questions--

## --text--

以下哪一種方式是更新狀態並為陣列添加新項目的正確方法？

## --answers--

```js
setItems(copy [prevItems, newItem]);
```

### --feedback--

要更新狀態中的陣列，你需要使用設值函式和正確的語法來為陣列添加新項目。

---

```js
setItems(new Array = [...prevItems, newItem]);
```

### --feedback--

要更新狀態中的陣列，你需要使用設值函式和正確的語法來為陣列添加新項目。

---

```js
items = (prevItems) => [...prevItems, newItem];
```

### --feedback--

要更新狀態中的陣列，你需要使用設值函式和正確的語法來為陣列添加新項目。

---

```js
setItems((prevItems) => [...prevItems, newItem]);
```

## --video-solution--

4

## --text--

為什麼你不應該直接修改 React 狀態中的陣列？

## --answers--

它會自動清除陣列。

### --feedback--

React 依賴不變性來偵測狀態的變更。

---

它會將不需要的重複項目添加到陣列中。

### --feedback--

React 依賴不變性來偵測狀態的變更。

---

它會導致組件中發生錯誤。

### --feedback--

React 依賴不變性來偵測狀態的變更。

---

它防止 React 偵測變更。

## --video-solution--

4

## --text--

在 React 狀態中，哪種方法最適合從陣列中移除一個項目？

## --answers--

`splice()`

### --feedback--

思考一個創建新陣列而不修改原始陣列的方法。

---

`push()`

### --feedback--

思考一個創建新陣列而不修改原始陣列的方法。

---

`pop()`

### --feedback--

思考一個創建新陣列而不修改原始陣列的方法。

---

`filter()`

## --video-solution--

4
