---
id: 687ea8bb2b781b19c790d00e
title: 什麼是 SQL 中的主鍵和外鍵，以及它們如何運作？
challengeType: 19
dashedName: what-are-primary-and-foreign-keys-in-sql-and-how-do-they-work
---

# --description--

在 SQL 中，主鍵和外鍵用於建立表格之間的關係。

讓我們從主鍵開始。

主鍵是唯一識別資料表中每筆記錄（列）的行或行集合。此條件確保資料表中不會有記錄擁有相同的主鍵值。

這就是為什麼一個資料表只能有一個主鍵。

主鍵行中的值也不能是 `NULL`，因此它們將始終具有有效值。

在 PostgreSQL 中，要將一個行設為你的資料表的主鍵，只需在型別後面添加 `PRIMARY KEY`：

```sql
column_name data_type PRIMARY KEY
```

這是一個 `students` 表的範例：

```sql
CREATE TABLE students (
  student_id SERIAL PRIMARY KEY,
  name VARCHAR(100)
);
```

每個學生都會有自己的 `student_id`，而這個 ID 將會是該資料表的主鍵。`SERIAL` 型別在這裡很有用，因為它確保 `student_id` 永遠會有唯一的值。

複合主鍵用於當資料表沒有單一唯一的行來識別列時。在這種情況下，你可以使用兩個或多個行的組合作為主鍵，這些行合起來是唯一的。

為此，當你創建資料表時，請像這樣標示哪些行是組合主鍵：

```sql
CREATE TABLE table_name (
  column1 data_type column_constraint,
  column2 data_type column_constraint,
  column3 data_type column_constraint,
  ...
  PRIMARY KEY (column1, column2)
);
```

假設你有一個包含 `student_id` 和 `course_id` 行的資料表，告訴你哪些學生選修了各種類別。

每個學生將會註冊多個類別，而每個類別也會有多個學生註冊。因此兩個行都不是唯一的－但你不會有同一個學生在同一個類別中註冊超過一次。因此你可以使用這兩個行的組合作為主鍵：

```sql
CREATE TABLE course_enrollments (
  student_id INT,
  course_id INT,
  ...
  PRIMARY KEY (student_id, course_id),
);
```

主鍵對於確保資料唯一性和完整性、優化資料檢索，以及在關聯式資料庫中建立與其他資料表的關係至關重要。

這將帶我們進入本課程中將涵蓋的下一種鍵型別：外鍵。

外鍵是資料表中取用另一資料表主鍵的行（或行集合）。一個資料表可以有多個外鍵。

在此範例中，我們有兩個資料表，`customers` 和 `orders`：

```sql
CREATE TABLE customers (
  customer_id SERIAL PRIMARY KEY,
  first_name VARCHAR(100) NOT NULL,
  ...
);

CREATE TABLE orders (
  order_id SERIAL PRIMARY KEY,
  customer_id INTEGER,
  ...
  FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
);
```

`customers` 資料表的主鍵是 `customer_id`，而 `orders` 資料表的主鍵是 `order_id`。

但請注意，`orders` 資料表中也有一個 `customer_id` 行。

為什麼我們要將客戶資訊儲存在 `orders` 表格中？

我們這麼做是為了在 `customers` 和 `orders` 資料表之間建立關聯。每筆訂單都會儲存提交該訂單的客戶 ID。

為了建立表格之間的關係，我們將使 `orders` 表格中的 `customer_id` 行成為一個外鍵，該外鍵引用 `customers` 表格中的 `customer_id` 行：

```sql
FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
```

外鍵行中的值必須與被引用資料表中的主鍵值相符，或為 `NULL`（如果外鍵允許 `NULL`）。

這為什麼有幫助？

透過確保這兩個資料表中的這些行完全相符，外鍵和主鍵可以防止產生「孤兒」記錄，即指涉另一個資料表中不存在記錄的記錄。

主鍵和外鍵是關聯式資料庫的基礎。它們驅動這些資料庫的「關聯」特性，使你能夠以準確的方式建模現實世界的資料。

# --questions--

## --text--

關聯式資料庫表格中主鍵的主要目的是什麼？

## --answers--

將該表格與其他表格聯結。

### --feedback--

思考是什麼讓表格中的每一列都獨特。

---

用以唯一識別資料表中的每個記錄。

---

定義行的資料型別。

### --feedback--

思考是什麼讓表格中的每一列都獨特。

---

在同一張資料表中強制執行外鍵關聯。

### --feedback--

思考是什麼讓表格中的每一列都獨特。

## --video-solution--

2

## --text--

一個資料表中的外鍵通常會參考另一個資料表中的哪個鍵？

## --answers--

另一個外鍵

### --feedback--

思考被引用表中哪個鍵確保由外鍵創建的關係的完整性和有效性。

---

唯一索引

### --feedback--

思考被引用表中哪個鍵確保由外鍵創建的關係的完整性和有效性。

---

主鍵

---

任何具有相同資料型別的行

### --feedback--

思考被引用表中哪個鍵確保由外鍵創建的關係的完整性和有效性。

## --video-solution--

3

## --text--

以下哪一項是主鍵的特徵？

## --answers--

它可以包含 NULL 值。

### --feedback--

請記住明確識別每一列的基本需求。

---

它可以在同一個表格中重複。

### --feedback--

請記住明確識別每一列的基本需求。

---

一個資料表可以有多個主鍵。

### --feedback--

請記住明確識別每一列的基本需求。

---

它必須包含唯一值。

## --video-solution--

4
