---
id: 67d30191adb999a9909109ef
title: 什麼是泛型，以及它們如何運作？
challengeType: 19
dashedName: what-are-generics-and-how-do-they-work
---

# --description--

你其實在之前的課程中看過一個泛型：`Array<string>`。但你通常會在函式中使用泛型。事實上，它們可以被視為你提供給函式的一個特殊參數，用來控制函式型別定義的行為。

讓我們回到先前從陣列取得隨機值的函式範例：

```js
const getRandomValue = (array: string[]): string => {
  return array[Math.floor(Math.random() * array.length)];
}
```

我們的函式接受一個字串陣列並傳回一個字串。但如果我們想傳入一個數字陣列並傳回一個數字呢？

你可以使用聯集（數學）型別：

```js
const getRandomValue = (array: (string|number)[]): (string|number) => {
  return array[Math.floor(Math.random() * array.length)];
}
const val = getRandomValue([1, 2, 4])
```

但是使用這種方法，即使我們傳入的陣列只有數字，TypeScript 仍然判定 `val` 變數可能是數字或字串。

相反地，你可以為該函式定義一個泛型型別：

```js
const getRandomValue = <T>(array: T[]): T => {
  return array[Math.floor(Math.random() * array.length)];
}
const val = getRandomValue([1, 2, 4])
```

我們的新範例中有幾個重要的組件。首先，`<T>` 語法告訴 TypeScript 你正在為該函式定義一個泛型類型 `T`。`T` 是泛型類型的常用名稱，但你實際上可以依照 JavaScript 的變數規則將它命名為任何你想要的名稱。

接著，我們告訴 TypeScript 陣列參數是符合泛型型別的值的陣列，且傳回值是該相同型別的單一元素。這讓 TypeScript 能正確偵測 `val` 將會是數字，因為我們傳入的陣列完全由數字組成。

但是你無法控制的函式呢？讓我們來看看 `document.querySelector()` 方法：

```js
const email = document.querySelector("#email");
console.log(email.value);
```

因為我們使用 ID 選擇器進行查詢，TypeScript 不知道我們查詢的是哪種類型的元素。它知道這是某種 `Element`，但我們嘗試存取 `value` 屬性時會發生錯誤，因為頂層元素介面沒有該屬性。

幸運地，我們可以將型別引數傳遞給函式呼叫：

```js
const email = document.querySelector<HTMLInputElement>("#email");
console.log(email.value);
```

注意我們如何再次使用尖括號語法（`<HTMLInputElement>`），但這次是在函式呼叫中。這告訴 TypeScript 我們預期找到的元素將會是 `input` 元素，因此在 value 屬性上不會再出現錯誤，因為 input 元素確實有該屬性。當然，如果找不到元素，`querySelector` 可能會傳回 `null`，而 TypeScript 會在這裡發出編譯器錯誤，因為我們沒有處理該情況。

但你會在下一課中學到那個。

# --questions--

## --text--

在函式中定義泛型型別的正確語法是什麼？

## --answers--

```ts
function<T>
```

---

```ts
<T>function
```

### --feedback--

泛型型別是在函式的參數列之前使用尖括號定義的。

---

```ts
(T)function
```

### --feedback--

泛型型別是在函式的參數列之前使用尖括號定義的。

---

```ts
function(T)
```

### --feedback--

泛型型別是在函式的參數列之前使用尖括號定義的。

## --video-solution--

1

## --text--

在以下範例中，`T[]` 表述什麼？

```ts
const getRandomValue = <T>(array: T[]): T => { ... }
```

## --answers--

任何型別的陣列。

### --feedback--

`T` 後面的方括號顯示該型別的陣列。

---

泛型型別 `T` 的陣列。

---

一個型別為 `T` 的元組。

### --feedback--

`T` 後面的方括號顯示該型別的陣列。

---

一個 `T` 型別的單一元素。

### --feedback--

`T` 後面的方括號顯示該型別的陣列。

## --video-solution--

2

## --text--

你如何在呼叫 `document.querySelector()` 時指定型別引數？

## --answers--

```js
document.querySelector("#email", HTMLInputElement)
```

### --feedback--

型別引數是使用尖括號，置於函式名稱與其參數之間傳遞。

---

```js
document.querySelector("#email"): HTMLInputElement
```

### --feedback--

型別引數是使用尖括號，置於函式名稱與其參數之間傳遞。

---

```js
document.querySelector<HTMLInputElement>("#email")
```

---

```js
document.querySelector("#email" as HTMLInputElement)
```

### --feedback--

型別引數是使用尖括號，置於函式名稱與其參數之間傳遞。

## --video-solution--

3
