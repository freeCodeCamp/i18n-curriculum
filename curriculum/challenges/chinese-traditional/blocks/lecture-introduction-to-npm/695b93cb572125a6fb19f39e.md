---
id: 695b93cb572125a6fb19f39e
title: 什麼是 `package-lock.json` 檔案？
challengeType: 19
dashedName: what-is-the-package-lock-json-file
---

# --description--

當你使用 npm 安裝相依性時，特別是在現有專案中，npm 會查看你的 `package.json` 檔案，以了解你的專案需要哪些軟體包。

`package.json` 中的每個相依性都包含像這樣的版本號：

```bash
"lodash": "^4.17.21"
```

如你先前所學，**插入符號 (^)** 允許 npm 安裝較新的次版本和修補版本，例如 `4.18.0` 或 `4.17.22`。這種彈性很有幫助，但也可能導致問題。

如果兩位開發者在不同時間執行 `npm install`，npm 可能會安裝同一軟體包的略微不同版本。即使是細微的差異也可能導致錯誤或意外行為。

`package-lock.json` 檔案解決了這個問題。它會在你第一次執行 `npm install` 時自動創建，並鎖定每個已安裝相依性的確切版本——包括所有子相依性，也就是相依性的相依性。

這可保證每次專案中所有人使用的軟體包版本都相同。

這是一個簡單的 `package.json` 檔案，將 `lodash` 作為相依性。

```bash
{
  "name": "package-lock-json",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "type": "commonjs",
  "dependencies": {
    "lodash": "^4.17.21"
  }
}
```

以下是來自 `package-lock.json` 的對應區段：

```bash
"node_modules/lodash": {
  "version": "4.17.21",
  "resolved": "https://registry.npmjs.org/lodash/-/lodash-4.17.21.tgz",
  "integrity": "sha512-v2kDEe57..."
}
```

注意差異：

* 在 `package.json` 中，`lodash` 被列為 `^4.17.21` — 一個彈性的規則。
    
* 在 `package-lock.json` 中，`lodash` 被鎖定為版本 `4.17.21`。
    

無論何時有人執行 `npm install`，他們都會獲得那個精確的版本。

這樣，不論何時有人執行 `npm install`，他們每次都會取得完全相同版本的 Lodash。

請注意，這也適用於子相依性，即你為你的專案使用的任何相依性的相依性。

例如，這是使用 Express 的專案中 `package-lock.json` 檔案的部分內容：

```json
{
  "name": "package-lock-json-file",
  "version": "1.0.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "package-lock-json-file",
      "version": "1.0.0",
      "license": "ISC",
      "dependencies": {
        "express": "^5.2.1"
      }
    },
    ...
    "node_modules/etag": {
      "version": "1.8.1",
      "resolved": "https://registry.npmjs.org/etag/-/etag-1.8.1.tgz",
      "integrity": "sha512-aIL5Fx7mawVa300al2BnEE4iNvo1qETxLrPI/o05L7z6go7fCw1J6EQmbK4FmJ2AS7kgVF/KEZWufBfdClMcPg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/express": {
      "version": "5.2.1",
      "resolved": "https://registry.npmjs.org/express/-/express-5.2.1.tgz",
      "integrity": "sha512-hIS4idWWai69NezIdRt2xFVofaF4j+6INOpJlVOLDO8zXGpUVEVzIYk12UUi2JzjEzWL3IOAxcTubgz9Po0yXw==",
      "license": "MIT",
      "dependencies": {
        "accepts": "^2.0.0",
        "body-parser": "^2.2.1",
        "content-disposition": "^1.0.0",
        "content-type": "^1.0.5",
        "cookie": "^0.7.1",
        "cookie-signature": "^1.2.1",
        "debug": "^4.4.0",
        "depd": "^2.0.0",
        "encodeurl": "^2.0.0",
        "escape-html": "^1.0.3",
        "etag": "^1.8.1",
        "finalhandler": "^2.1.0",
        "fresh": "^2.0.0",
        "http-errors": "^2.0.0",
        "merge-descriptors": "^2.0.0",
        "mime-types": "^3.0.0",
        "on-finished": "^2.4.1",
        "once": "^1.4.0",
        "parseurl": "^1.3.3",
        "proxy-addr": "^2.0.7",
        "qs": "^6.14.0",
        "range-parser": "^1.2.1",
        "router": "^2.2.0",
        "send": "^1.1.0",
        "serve-static": "^2.2.0",
        "statuses": "^2.0.1",
        "type-is": "^2.0.1",
        "vary": "^1.1.2"
      },
      "engines": {
        "node": ">= 18"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/express"
      }
    },
    ...others
  }
}
```

你可以看到除了 Express 本身之外，還有其他軟體包像是 `accepts`、`mime-types` 和 `negotiator`。這些是子相依性，是 Express 內部運作所依賴的軟體包。

另外請注意，雖然 `node_modules/express` 中的 `dependencies` 確實使用了插入符號字元來表示區間，但如果你找到每個子相依項的條目，例如 `node_modules/etags`，它們是固定在特定版本的。

簡而言之，`package-lock.json` 檔案讓所有人保持一致，並確保在開發者機器、CI 伺服器、部署及其他環境中保持一致性。

務必始終使用 Git 提交你的 `package-lock.json` 檔案，這樣你的團隊才能共用相同的設定。此外，請勿手動編輯 `package-lock.json` 檔案—每當依賴項變更時，npm 會自動更新它。

# --questions--

## --text--

`package-lock.json` 檔案如何解決不同環境之間的版本不一致問題？

## --answers--

透過自動將所有相依性更新到最新版本。

### --feedback--

想想它如何確保每個人安裝相同的相依性版本。

---

透過在安裝新依賴項之前刪除舊依賴項。

### --feedback--

想想它如何確保每個人安裝相同的相依性版本。

---

透過凍結已安裝的相依套件的精確版本。

---

只儲存每個相依性的主要版本號。

### --feedback--

想想它如何確保每個人安裝相同的相依性版本。

## --video-solution--

3

## --text--

為什麼你應該始終將你的 `package-lock.json` 檔案提交到 Git？

## --answers--

為了讓你的機器上 `npm run` 更快。

### --feedback--

考慮保持每個開發者的環境一致。

---

讓你的團隊共用相同的相依性版本和設定。

---

自動更新過期的相依性。

### --feedback--

考慮保持每個開發者的環境一致。

---

為了減少你的 Git 儲存庫大小。

### --feedback--

考慮保持每個開發者的環境一致。

## --video-solution--

2

## --text--

什麼是子相依性？

## --answers--

在專案中已安裝但從未使用的軟體包。

### --feedback--

思考你的主要依賴項本身所依賴的依賴項。

---

依賴你專案主要檔案來執行的軟體包。

### --feedback--

思考你的主要依賴項本身所依賴的依賴項。

---

只在開發期間使用的軟體包。

### --feedback--

思考你的主要依賴項本身所依賴的依賴項。

---

你的相依性內部運作所依賴的軟體包。

## --video-solution--

4
