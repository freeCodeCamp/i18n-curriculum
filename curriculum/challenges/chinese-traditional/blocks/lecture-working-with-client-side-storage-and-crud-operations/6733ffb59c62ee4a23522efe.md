---
id: 6733ffb59c62ee4a23522efe
title: 什麼是 IndexedDB，以及它如何運作？
challengeType: 19
dashedName: what-is-indexeddb-and-how-does-it-work
---

# --interactive--

`IndexedDB` 是瀏覽器中用於儲存結構化資料的工具。這是內建於現代網頁瀏覽器中，允許網頁應用程式高效地儲存和擷取 JavaScript 物件。

與其他像 `localStorage` 這類僅限於儲存字串的儲存機制不同，`IndexedDB` 可以儲存 JavaScript 物件、檔案，以及幾乎任何其他類型的資料。這使得需要處理大型且複雜資料結構的網頁應用程式變得容易。

現在，讓我們來看看 `IndexedDB` 如何運作。 

第一步是打開資料庫。以下是一個範例：

:::interactive_editor

```js
let request = indexedDB.open("Sample DB", 1);

request.onerror = function(event) {
  console.log("Error opening database");
};

request.onsuccess = function(event) {
  let db = event.target.result;
  console.log("Database opened successfully");
};
```

:::

在這段程式碼中，我們正在開啟一個名為 `"Sample DB"`、版本為 1 的資料庫。我們提供兩個回呼函式：一個用於處理錯誤，另一個用於資料庫成功開啟時。成功回呼中取得的 `db` 物件是我們用來與資料庫互動的。

如果你檢查瀏覽器開發工具的應用程式介面，你會看到你的 `Sample DB` 已在 `IndexedDb` 區段中開啟。當你的資料庫開啟後，你就可以開始操作物件儲存區。

IndexedDB 中的物件存放區類似於傳統資料庫中的資料表。它們保存你想要儲存的實際資料。以下是如何創建物件存放區： 

```js
let request = indexedDB.open("Sample DB", 1);

request.onupgradeneeded = function(event) {
  let db = event.target.result;
  let objectStore = db.createObjectStore("customers", { keyPath: "id" });
};
```

這段程式碼創建了一個名為 `"customers"` 的物件存放區，並以 `"id"` 作為其鍵路徑。鍵路徑就像傳統資料庫中的主鍵－用來唯一識別每筆記錄。

為你的物件儲存新增資料，我們會這樣做。此範例中的 `db` 表述 `IndexedDB` 資料庫實體。

```js
let transaction = db.transaction(["customers"], "readwrite");
let objectStore = transaction.objectStore("customers");
let request = objectStore.add({ id: 1, name: "John Doe", email: "john@example.com" });

request.onerror = function(event) {
  console.log("Error adding data");
};

request.onsuccess = function(event) {
  console.log("Data added successfully");
};
```

這段程式碼將一個新的客戶添加到我們的 `"customers"` 物件儲存區。我們啟動一個交易（這是我們如何將資料庫操作群組化的方式），取得我們物件儲存區的引用，然後添加我們的資料。

擷取資料的方式類似。我們先開始一個交易，取得我們的物件存放區，然後使用像 `get` 這樣的方法來擷取資料：

```js
let transaction = db.transaction(["customers"]);
let objectStore = transaction.objectStore("customers");
let request = objectStore.get(1);

request.onerror = function(event) {
  console.log("Error retrieving data");
};

request.onsuccess = function(event) {
  console.log("Customer:", request.result);
};
```

這段程式碼從我們的 `"customers"` 物件儲存區中擷取 `id` 為 `1` 的客戶。

`IndexedDB` 的其中一個關鍵特性是它是非同步的。

這表示當你與 `IndexedDB` 互動時，操作不會阻塞網頁應用程式的主執行緒。這確保即使處理大量資料，你的網頁應用程式仍保持回應。

雖然 `IndexedDB` 提供強大的功能，但與其他較簡單的儲存 API 選項相比，它的學習曲線較陡峭，對初學者來說可能具有挑戰性。然而，對於需要在客戶端控制大量結構化資料的應用程式，`IndexedDB` 提供無與倫比的能力。

# --questions--

## --text--

`IndexedDB` 操作的一個主要特徵是什麼？

## --answers--

它們總是同步的。

### --feedback--

考慮 `IndexedDB` 操作如何與網頁應用程式的主執行緒互動。

---

它們總是非同步的。

---

它們只適用於字串資料。

### --feedback--

考慮 `IndexedDB` 操作如何與網頁應用程式的主執行緒互動。

---

它們需要持續的網際網路連接。

### --feedback--

考慮 `IndexedDB` 操作如何與網頁應用程式的主執行緒互動。

## --video-solution--

2

## --text--

使用 `IndexedDB` 相較於 `localStorage` 的主要優勢是什麼？

## --answers--

`IndexedDB` 更容易使用。

### --feedback--

考慮每種儲存方法可以控制代碼的資料型別，以及這如何影響它們的使用情境。

---

`IndexedDB` 支援直接儲存複雜的 JavaScript 物件。

---

`IndexedDB` 是同步的。

### --feedback--

考慮每種儲存方法可以控制代碼的資料型別，以及這如何影響它們的使用情境。

---

舊版瀏覽器支援 `IndexedDB`。

### --feedback--

考慮每種儲存方法可以控制代碼的資料型別，以及這如何影響它們的使用情境。

## --video-solution--

2

## --text--

在 `IndexedDB` 中，物件儲存區最類似於傳統關聯式資料庫中的什麼？

## --answers--

一個資料庫。

### --feedback--

請考慮 `IndexedDB` 中資料的組織方式與傳統 SQL 資料庫的不同。

---

一個表格。

---

一列。

### --feedback--

請考慮 `IndexedDB` 中資料的組織方式與傳統 SQL 資料庫的不同。

---

一個行。

### --feedback--

請考慮 `IndexedDB` 中資料的組織方式與傳統 SQL 資料庫的不同。

## --video-solution--

2
