---
id: 5900f4231000cf542c50ff35
title: 'Problema 182: cifrado RSA'
challengeType: 1
forumTopicId: 301818
dashedName: problem-182-rsa-encryption
---

# --description--

El cifrado RSA se basa en el siguiente procedimiento:

Genera dos primos distintos `p` y `q`.  
Calcula `n=p*q` y `φ=(p-1)(q-1)`.  
Encuentra un entero `e`, `1 < e < φ`, tal que `gcd(e,φ) = 1`

Un mensaje en este sistema es un número en el intervalo `[0,n-1]`.  
Un texto que se va a encriptar se convierte de alguna manera en mensajes (números en el intervalo `[0,n-1]`).  
Para encriptar el texto, para cada mensaje, `m`, se calcula c=m<sup>e</sup> mod n.

Para descifrar el texto, se necesita el siguiente procedimiento: calcula `d` tal que `ed=1 mod φ`, luego para cada mensaje cifrado, `c`, calcula m=c<sup>d</sup> mod n.

Existen valores de `e` y `m` tales que m<sup>e</sup> mod n = m.  
Llamamos mensajes `m` a aquellos para los cuales m<sup>e</sup> mod n = m, mensajes no ocultos.

Un problema al elegir `e` es que no debe haber demasiados mensajes no ocultos.  
Por ejemplo, sea `p=19` y `q=37`.  
Entonces `n=19*37=703` y `φ=18*36=648`.  
Si elegimos `e=181`, entonces, aunque `gcd(181,648)=1`, resulta que todos los mensajes posibles  
m `(0≤m≤n-1)` no están ocultos al calcular m<sup>e</sup> mod n.  
Para cualquier elección válida de `e` existen algunos mensajes no ocultos.  
Es importante que el número de mensajes no ocultos sea mínimo.

Para cualquier `p` y `q` dados, encuentra la suma de todos los valores de `e`, `1 < e < φ(p,q)` y `gcd(e,φ)=1`, de modo que el número de mensajes no ocultos para este valor de `e` sea mínimo.

# --hints--

`RSAEncryption` debería ser una función.

```js
assert.isFunction(RSAEncryption);
```

`RSAEncryption` debería devolver un número.

```js
assert.strictEqual(typeof RSAEncryption(19, 37), 'number');
```

`RSAEncryption(19, 37)` debería devolver `17766`.

```js
assert.strictEqual(RSAEncryption(19, 37), 17766);
```

`RSAEncryption(283, 409)` debería devolver `466196580`.

```js
assert.strictEqual(RSAEncryption(283, 409), 466196580);
```

`RSAEncryption(1009, 3643)` debería devolver `399788195976`.

```js
assert.strictEqual(RSAEncryption(19, 37), 17766);
```

# --seed--

## --seed-contents--

```js
function RSAEncryption(p, q) {

  return true;
}

RSAEncryption(19, 37);
```

# --solutions--

```js
function gcd(a, b) {
    if (b)
        return gcd(b, a % b);
    else
        return a;
}

function RSAEncryption(p, q) {
    let phi = (p - 1) * (q - 1);

    let best = Number.MAX_SAFE_INTEGER;
    let sum = 0;

    for (let e = 0; e < phi; ++e) {
        if (!(gcd(e, phi) == 1))
            continue;

        let msg = (gcd(p - 1, e - 1) + 1) * (gcd(q - 1, e - 1) + 1);

        if (best == msg) {
            sum += e;
        } else if (best > msg) {
            best = msg;
            sum = e;
        }
    }

    return sum;
}
```
