---
id: 67db31c7ed46f430ce6c2da6
title: 模拟、伪造和存根之间有什么区别？
challengeType: 19
dashedName: what-are-the-differences-between-mocking-faking-and-stubbing
---

# --description--

模拟是假数据替换真实数据的过程，该假数据模拟真实组件的行为。这使得测试人员和开发人员能够测试应用中的特定组件，而无需依赖外部依赖。

模拟数据的一个常见使用分支是在处理 API 调用时。假设你的应用中有这样一个 fetch 调用：

```js
export const postService = {
  async getPosts() {
    const response = await fetch("https://api.example.com/posts");
    return response.json();
  },
};
```

如果你需要测试 `postService` 函数，你可以模拟 API 响应，而不是连续调用 API 来获取数据。从 API 获取数据需要时间，并且依赖于网络可用性和服务器响应等外部因素。模拟 API 响应可以消除这些外部因素，使测试人员能够使用可预测、受控的数据集。

这是一个示例模拟 API `Response`：

```json
[
  {
    "id": 1,
    "title": "Understanding Async/Await in JavaScript",
    "content": "Async/Await makes asynchronous code look and behave like synchronous code...",
    "author": "Jane Doe",
    "created_at": "2025-04-10T14:32:00Z"
  },
  {
    "id": 2,
    "title": "10 Tips for Writing Clean Code",
    "content": "Clean code is not just about code formatting. It involves naming, architecture...",
    "author": "John Smith",
    "created_at": "2025-04-08T09:21:00Z"
  },
  {
    "id": 3,
    "title": "Exploring React 19 Features",
    "content": "React 19 comes with exciting features like new hooks and better performance...",
    "author": "Alex Lee",
    "created_at": "2025-04-07T18:47:00Z"
  }
]
```

既然我们已经了解了什么是 mocking，现在让我们将其与 stubbing 进行比较。Stub 是返回预定义响应或虚拟数据的对象，用于应用中预期的行为。例如，你可以在测试中为数据库连接的行为进行 stub，而无需依赖实际的数据库连接。

下面是 Jest 中存根的示例：

```js
import { postService } from "./postService";
import { db } from "./db";

jest.mock("./db", () => ({
  db: {
    fetchPosts: jest.fn(),
  },
}));

test("should return stubbed posts", async () => {
  const fakePosts = [
    { id: 1, title: "Stubbed Post", content: "This is a stubbed post." },
  ];

  db.fetchPosts.mockResolvedValue(fakePosts);

  const posts = await postService.getPosts();

  expect(posts).toEqual(fakePosts);
});
```

`db.fetchPosts.mockResolvedValue(fakePosts);` 是此示例中的存根。

最后要讨论的组件是 fakes。fakes 是真实组件的简化版本，没有真实组件的复杂度或副作用。例如，你可以通过将数据存储在内存中而不是与真实数据库交互来伪造数据库。这将允许你在内存中模拟数据库操作，这比处理真实数据库要快得多。另一个常见的例子是在处理文件系统时使用 fakes。在测试时，你可以创建一个伪造的文件系统来代替真实的文件系统。

随着你继续构建更复杂的软件应用，考虑在你的测试中适当使用 mocks、stubs 或 fakes。

# --questions--

## --text--

以下哪项是使用 mock 进行测试的常见用例？

## --answers--

模拟超文本标记语言 更改。

### --feedback--

参考课程开始时讨论的内容。

---

模拟 CSS 更改。

### --feedback--

参考课程开始时讨论的内容。

---

模拟 API 调用。

---

模拟 JavaScript 字串方法。

### --feedback--

参考课程开始时讨论的内容。

## --video-solution--

3

## --text--

测试中的存根是什么？

## --answers--

在测试环境中返回 null 的对象。

### --feedback--

考虑在测试场景中你想要使用的受控响应。

---

返回预定义响应的对象。

---

进行多次 API 调用的对象。

### --feedback--

考虑在测试场景中你想要使用的受控响应。

---

在 React 应用中对 UI 进行多次更新的对象。

### --feedback--

考虑在测试场景中你想要使用的受控响应。

## --video-solution--

2

## --text--

以下哪项是假对象的常见使用分支？

## --answers--

伪造用于 post 请求的 API 调用。

### --feedback--

参考课程结尾处对此的讨论。

---

伪造应用的样式。

### --feedback--

参考课程结尾处对此的讨论。

---

伪造一个 HTML 文件。

### --feedback--

参考课程结尾处对此的讨论。

---

伪造数据库。

## --video-solution--

4
