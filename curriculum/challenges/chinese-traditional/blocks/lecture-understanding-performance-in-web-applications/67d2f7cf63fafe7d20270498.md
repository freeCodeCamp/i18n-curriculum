---
id: 67d2f7cf63fafe7d20270498
title: 你如何使用 Performance Web APIs 來創建你自己的效率測量工具？
challengeType: 19
dashedName: how-can-you-use-performance-web-apis-to-create-your-own-performance-measurement-tools
---

# --description--

雖然像 Lighthouse 和 Chrome DevTools 這類工具很棒，但有時你需要為你的網站訂製的洞察。

這就是 Performance Web APIs 派上用場的地方！

在本課程中，我們將解析如何使用三個關鍵的 Web API 來測量和分析你的網站速度。

但首先，什麼是 Performance Web APIs？ 

Performance Web APIs 讓開發者能夠直接從程式碼追蹤網頁載入和回應的高效程度。這些 API 允許你測量頁面載入時間、追蹤呈現和互動延遲，以及分析 JavaScript 執行時間。

使用這些 API，你可以建置你自己的效率監控工具，而不必依賴第三方軟體！

讓我們探索三個你今天就能使用的強大 Web API。

首先是 `performance.now()`。

此 API 提供你高精度的時間戳記（以毫秒為單位），用來測量你網站不同零件載入所花費的時間。

假設你想測量一個函式（程式）執行的速度：

```js
const start = performance.now();  
// Run some code here  
const end = performance.now();  

console.log(`Execution time: ${end - start}ms`);
```

這比使用 `Date.now()` 更準確，因為它以微秒精度測量毫秒時間，避免時鐘漂移問題。你可以用它來追蹤腳本執行時間、事件回應延遲和動畫效率。

接下來是 Performance Timing API。

此 API 為你提供從 DNS 查詢到 `DOMContentLoaded` 的每個頁面載入階段的詳細分析。

想要測量你的頁面完全載入所需的時間嗎？

```js
let [navigationTiming] = performance.getEntriesByType("navigation");

if (navigationTiming instanceof PerformanceNavigationTiming) {
  // Calculate time from navigation start to DOM content loaded
  const pageLoadTime =
    navigationTiming.domContentLoadedEventEnd - navigationTiming.startTime;

  console.log("DOM Content Loaded Time:", pageLoadTime, "ms");
}
```

你可以使用此 API 追蹤的關鍵指標包括 DNS 查詢時間－換句話說即連線速度、Time to First Byte (TTFB)－即伺服端回應速度，以及 `DOMContentLoaded`－換句話說即頁面準備好互動的時間。

如果你的頁面載入時間很慢，這個 API 能精確指出延遲發生的位置！

最後，讓我們來談談 `PerformanceObserver`。

此 API 監聽如版面移動、長時間任務和使用者互動等效率事件。

想監控長時間執行的 JavaScript 任務？

```js
const observer = new PerformanceObserver((list) => {  
  list.getEntries().forEach((entry) => {  
    console.log(`Long task detected: ${entry.duration}ms`);  
  });  
});  

observer.observe({ type: "longtask", buffered: true });
```

這個 API 可以追蹤什麼？它可以追蹤長時間任務－換句話說，就是阻塞呈現的 JavaScript、用來偵測 UI 卡頓的版面配置變動，以及 First Input Delay（FID）－也就是頁面對使用者輸入的回應速度。

如果你想要即時效率追蹤，這個 API 是遊戲規則改變者。

那麼，你應該使用哪個 API 呢？這裡有一個快速比較：

| Performance API        | Best For                                           |
| :--------------------- | :------------------------------------------------- |
| `performance.now()`    | Precise timing of functions and scripts            |
| Performance Timing API | Measuring full page load performance               |
| Performance Observer   | Real-time monitoring of interactions and rendering |

透過結合這些 API，你可以建置自己的效率測量工具，並精確追蹤對你的網站最重要的項目。

# --questions--

## --text--

使用 `performance.now()` 相較於 `Date.now()` 的主要優點是什麼？

## --answers--

它更精確，並以微秒精度測量毫秒時間。

---

它僅適用於行動裝置，且不支援桌上型電腦。

### --feedback--

思考為什麼在測量速度時精確度很重要。

---

它會測量系統記憶體使用量，包括瀏覽器的記憶體足跡。

### --feedback--

思考為什麼在測量速度時精確度很重要。

---

它有助於 CSS 動畫。

### --feedback--

思考為什麼在測量速度時精確度很重要。

## --video-solution--

1

## --text--

哪個 API 可以追蹤拖慢你網站的長時間 JavaScript 任務？

## --answers--

效率計時 API

### --feedback--

想像一個 API 即時監聽效能事件。

---

`Performance.now()`

### --feedback--

想像一個 API 即時監聽效能事件。

---

效率觀察器

---

PageSpeed Insights

### --feedback--

想像一個 API 即時監聽效能事件。

## --video-solution--

3

## --text--

`Performance Timing API` 幫助測量什麼？

## --answers--

單一 JavaScript 函式（程式）執行時間。

### --feedback--

想像一個追蹤頁面載入每個階段的 API。

---

整頁載入效率，包括 DNS 查詢和 TTFB。

---

使用者互動，例如按鈕點擊。

### --feedback--

想像一個追蹤頁面載入每個階段的 API。

---

網頁上的影像數量。

### --feedback--

想像一個追蹤頁面載入每個階段的 API。

## --video-solution--

2
