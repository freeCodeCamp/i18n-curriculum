---
id: 692aba0978ca391f10455b4a
title: 你如何将一个包发布到 npm 注册表？
challengeType: 19
dashedName: how-can-you-publish-a-package-to-the-npm-registry
---

# --description--

让我们了解一下 npm registry，在这里你可以与全世界分享你的 JavaScript 包。

**npm registry** 是一个公共和私有包的数据库。

开发者和组织可以将包发布到此注册表，以便与他们的社区和团队成员共享他们的工具，并且在许多情况下，与所有其他 Node.js 开发者共享。

包可以是公共的或私有的。公共包可以被任何人访问。私有包只能被特定用户或组织成员访问。

在 npm 注册表中，你只需点击几下就可以与全世界分享你所构建的内容。听起来很棒，对吧？

让我们一步步看看你如何发布一个 `package`。

## 第 1 步：创建账户

第一步是创建一个免费的 npm 账户。要创建你的账户：

* 访问 https://www.npmjs.com/signup。
    
* 填写该形式。你需要输入你的用户名、电子邮件和密码。
    

请注意，根据注册页面，“你的电子邮件地址将被添加到你发布的 `package` 的元数据中，因此可能会被公开看到。”

## 步骤 2：**登录**

一旦你有了 npm 账户，你需要通过运行此命令在终端登录：

```bash
npm login
```

然后你需要使用你的账户信息进行身份验证。

## **步骤 3：创建一个** `package.json` 文件

在你发布你的包之前，你需要使用此命令创建一个 `package.json` 文件：

```bash
npm init
```

如果你的项目已经有一个，你可以直接进入**步骤 4**。

你需要为你的 `package.json` 文件输入这些信息：

* **name**：这通常是你的项目/目录的名称。如果你计划将你的包公开，此名称必须是唯一的，除非你使用作用域（我们稍后会讲到这个）。
    
* **version**：你应该从 `"1.0.0"` 开始，这是默认值。这表现你的包的初始版本，你可以在对包进行更改时更新它。
    
* **main**：你的项目的入口点。默认是 `index.js`。
    
* **author**：你可以写你的名字或首选处理器。
    
* **license**：选择一个特定的许可证。一些示例包括 MIT 和 ISC。
    
* **description**：你的包的简要摘要。
    

在选择你的包名称时，确保它尚未被 npm 注册表占用。为此，你可以访问以下 URL，将 `<your-package-name>` 替换为你的包名称：

```bash
https://www.npmjs.com/package/<your-package-name>
```

如果该 URL 没有包，则包名可用，你可以使用它。

但是，如果名称已经被占用且你确实想保留它，你可以使用称为 **作用域** 的东西来发布它。

### **作用域**

当你在 npm 注册表中创建用户或组织账户时，会为你授予一个以你的用户名或组织名称命名的作用域。

作用域有助于避免名称冲突，因为你可以在你的作用域下发布你的包，即使已经存在同名的其他包。

带作用域的包的名称以作用域名称开头。例如，在 `package.json` 中，你会查找到这个密钥-值点对：

```bash
"name": "@<scope-name>/<your-package-name>"
```

如果需要，你可以直接在文件中进行此更改，或者你可以通过为 `npm init` 命令添加 `--scope=@<scope-name>` 来从一开始就创建带有作用域的 `package.json` 文件。

```bash
npm init --scope=@<scope-name>
```

作用域名称可以是你的用户名（如果你使用的是个人账户），也可以是你的组织名称（如果你使用的是组织账户）。

## 第 4 步：创建 README.md

你的 `package` 的 README 是一个 markdown `file`，你在其中描述你的 `package` 的功能及其预期用途。

你可能想要包含的一些重要内容示例有：

* 它的目的。
    
* 如何安装它。
    
* 重要的依赖项和注意事项。
    
* 如何开始。
    
* 样本代码截图。
    
* 贡献指南（如果你接受贡献）。
    
* 链接到一个 changelog 文件，在其中跟踪不同版本中所做的更改。
    

README 的结构是灵活的。你可以根据你的需求进行调整。

## **第 5 步：** `.npmignore`

`.npmignore` 文件告诉 npm 注册表在发布你的包时包含哪些文件和忽略哪些文件。防止共享敏感信息，如私有密钥、密码和个人信息，非常重要。

在这个文件中，你可以编写模式来指定哪些文件、目录和文件类型被忽略。它遵循与 `.gitignore` 文件相同的模式匹配规则。

如果你使用过 Git，你可能会觉得这个文件听起来和 `.gitignore` 非常相似，对吧？那是因为它确实如此。根据 npm 文档，“如果没有 `.npmignore` 文件，但有 `.gitignore` 文件，那么 npm 会忽略被 `.gitignore` 文件匹配的内容。”

你还应该知道，npm 会在你的包的所有子目录中查找 `.npmignore` 和 `.gitignore` 文件，而不仅仅是根目录。

默认情况下，这些路径会被自动忽略，因此你不需要将它们添加到 `.npmignore`：

* `.*.swp`
    
* `._*`
    
* `.DS_Store`
    
* `.git`
    
* `.gitignore`
    
* `.hg`
    
* `.npmignore`
    
* `.npmrc`
    
* `.lock-wscript`
    
* `.svn`
    
* `.wafpickle-*`
    
* `config.gypi`
    
* `CVS`
    
* `npm-debug.log`
    

`node_modules` 目录也会被忽略，除非是捆绑的依赖。

## **第 6 步：发布你的包**

在将你的包发布到 npm 注册表之前，你应该通过运行此命令进行测试：

```bash
npm install <full-path-to-package-directory>
```

一旦你准备好发布，命令将取决于 `package` 的 `type`：有作用域与无作用域。

如果你的 `package` 没有作用域，运行此命令：

```bash
npm publish
```

如果你的包是有作用域的，它将默认作为私有包发布（如果你的账户支持此特色）。如果你想将其公开，你需要为该命令添加 `--access public`。

```bash
npm publish --access public
```

要查看你的公共包，请访问此 URL：

```bash
https://npmjs.com/package/<your-package-name>
```

你应该在包名下方看到你的包的可见性指示（公开或私有）。

## **第 7 步（可选）：安装你的包**

现在你已经完成设置，可以使用此命令在 Node.js 项目中安装你的包：

```bash
npm install <your-package-name>
```

## 更新你的包

如果你需要在发布后对你的包进行更改，可以在 `package.json` 中更新包版本。

这是语义化版本控制的标准约定：

* **首次版本：** `1.0.0`。
    
* **补丁版本：** 增加第三位数字。例如，从 `1.0.0` 更新到 `1.0.1`。
    
* **次要版本：** 增加中间的数字并将最后一个数字重置为零。例如，将 `1.0.0` 更新为 `1.1.0`。
    
* **重大版本：** 增加第一个数字，并将中间和最后的数字重置为零。例如，将 `1.1.0` 更新为 `2.0.0`。
    
干得好。现在你知道如何将你的 `package` 发布到 npm 注册表，以及如何更新它以修复错误和添加新特色。

# --questions--

## --text--

在终端中用于将包从你的局部机器上传到 npm 注册表的命令是什么？

## --answers--

`npm install <package-name>`

### --feedback--

这是完成进程的命令，使你的包可供其他人安装。

---

`npm start`

### --feedback--

这是完成进程的命令，使你的包可供其他人安装。

---

`npm add`

### --feedback--

这是完成进程的命令，使你的包可供其他人安装。

---

`npm publish`

## --video-solution--

4

## --text--

目录中必须存在什么文件才能向 npm 注册表表明该文件夹是一个完整的、可安装的包？

## --answers--

`README.md`

### --feedback--

考虑包含所有必需元数据、依赖项和 npm 项目配置的文件。

---

`index.js`

### --feedback--

考虑包含所有必需元数据、依赖项和 npm 项目配置的文件。

---

`package.json`

---

`.npmignore`

### --feedback--

考虑包含所有必需元数据、依赖项和 npm 项目配置的文件。

## --video-solution--

3

## --text--

你应该采取什么操作以确保在发布包时**不**包含敏感信息？

## --answers--

在 `npm publish` 之前暂时从项目文件夹中删除文件。

### --feedback--

npm 使用特定的文件来决定从发布的包中排除什么内容。

---

使用 `.ignore` 文件列出敏感文件。

### --feedback--

npm 使用特定的文件来决定从发布的包中排除什么内容。

---

使用 `.npmignore` 文件列出敏感文件。

---

在 `package.json` 中将 `private` 字段设置为 `true`。

### --feedback--

npm 使用特定的文件来决定从发布的包中排除什么内容。

## --video-solution--

3
