---
id: 6724e3d6e1cb0c1fec3a8e4f
title: SQL 和 PostgreSQL 复习
challengeType: 31
dashedName: review-sql-and-postgresql
---

# --description--

## 关系数据库简介

- **关系数据库**：将数据组织成由行和列组成的相关表格。每行表现一个记录，每列表现数据的一个属性。
- **关系数据库的优势**：可扩展，广泛适用于各个域（例如，医疗、商业、游戏），并且结构化以维护可靠的数据。
- **常见使用分支**：网页开发、库存系统、电子商务、医疗保健和企业应用。

## 密钥概念

- **模式**：关系数据库需要一个模式来定义其结构——表格、列、数据类型、约束和关系。
- **主键**：表格中每行的唯一标识符。它们对于数据完整性至关重要，并用于通过外键关联表格之间的记录。
- **外键**：对另一个表格中主键的引用，用于链接跨表格的相关数据。
- **关系**：通过主键和外键连接表格，你可以构建规范化的数据并执行有意义的查询。
- **实体关系图（ERDs）**：可视化实体（表格）在数据库模式中如何相互关联。
- **数据完整性**：使用密钥和数据类型强制执行。确保保存数据的一致性和准确性。

## SQL 基础

- **查询**：用于从数据库中检索特定数据的请求。

```sql
SELECT * FROM dogs WHERE age < 3;
```

- **WHERE 子句**：根据条件过滤结果。使用比较操作符如 `<`、`=`、`>` 等。
- **使用 ORDER BY 选择**：基于某个列检索并排序结果。

```sql
SELECT columns FROM table_name ORDER BY column_name;
```

## 表格操作

- **`CREATE TABLE` 语句**：此语句用于在数据库中创建新建表格。

```sql
CREATE TABLE first_table();
```

- **`ALTER TABLE ADD COLUMN` 语句**：此语句用于为现有表格添加列。

```sql
ALTER TABLE table_name ADD COLUMN column_name DATATYPE;
```

- **`ALTER TABLE DROP COLUMN` 语句**：此语句用于从现有表格中删除一列。

```sql
ALTER TABLE table_name DROP COLUMN column_name;
```

- **`ALTER TABLE RENAME COLUMN` 语句**：此语句用于重命名表格中的列。

```sql
ALTER TABLE table_name RENAME COLUMN column_name TO new_name;
```

- **`DROP TABLE` 语句**：此语句用于从数据库中删除整个表格。

```sql
DROP TABLE table_name;
```

- **`ALTER DATABASE RENAME` 语句**：此语句用于重命名数据库。

```sql
ALTER DATABASE database_name RENAME TO new_database_name;
```

- **`DROP DATABASE` 语句**：此语句用于删除整个数据库。

```sql
DROP DATABASE database_name;
```

## 约束与数据完整性

- **带约束的 `ALTER TABLE ADD COLUMN`**：此语句用于为现有表格添加带约束的列。

```sql
ALTER TABLE table_name ADD COLUMN column_name DATATYPE CONSTRAINT;
```

- **`NOT NULL` 约束**：此约束确保某个列不能有 NULL 值。

```sql
column_name VARCHAR(50) NOT NULL
```

- **`ALTER TABLE ADD PRIMARY KEY` 语句**：此语句用于为表格添加主键约束。

```sql
ALTER TABLE table_name ADD PRIMARY KEY(column_name);
```

- **`ALTER TABLE DROP CONSTRAINT` 语句**：此语句用于从表格中删除约束。

```sql
ALTER TABLE table_name DROP CONSTRAINT constraint_name;
```

- **`ALTER TABLE ADD COLUMN` 带外键**：此语句用于添加引用另一个表格的外键列。

```sql
ALTER TABLE table_name ADD COLUMN column_name DATATYPE REFERENCES referenced_table_name(referenced_column_name);
```

- **`ALTER TABLE ADD UNIQUE` 语句**：此语句用于为列添加 UNIQUE 约束。

```sql
ALTER TABLE table_name ADD UNIQUE(column_name);
```

- **`ALTER TABLE ALTER COLUMN SET NOT NULL` 语句**：此语句用于为现有列设置 NOT NULL 约束。

```sql
ALTER TABLE table_name ALTER COLUMN column_name SET NOT NULL;
```

- **带有 NULL 值的 `INSERT` 语句**：此语句演示如何将 NULL 值插入到表格中。

```sql
INSERT INTO table_name(column_a) VALUES(NULL);
-- or
INSERT INTO table_name(column_b) VALUES('value'); -- if column_a allows nulls
```

- **复合主键**：此约束定义由多个列组成的主键。

```sql
CREATE TABLE course_enrollments (
    student_id INT,
    course_id INT,
    PRIMARY KEY (student_id, course_id)
);
```

## 数据操作（CRUD）

- **`INSERT` 语句**：此语句用于向表格中插入单行。

```sql
INSERT INTO table_name(column_1, column_2) VALUES(value1, value2);
```

- **省略列的 `INSERT` 语句**：此语句演示如何在不显式列出列名的情况下插入值，依赖于表格中的默认列顺序。

```sql
INSERT INTO dogs VALUES ('Gino', 3);
```

- **带有多行的 `INSERT` 语句**：此语句用于在单次操作中将多行插入到表格中。

```sql
INSERT INTO dogs (name, age) VALUES 
('Gino', 3),
('Nora', 2);
```

- **`UPDATE` 语句**：此语句用于根据条件更新表格中现有的数据。

```sql
UPDATE table_name SET column_name=new_value WHERE condition;
```

- **`DELETE` 语句**：此语句用于根据条件从表格中删除行。

```sql
DELETE FROM table_name WHERE condition;
```

## 数据类型

- **`NUMERIC` 数据类型**：此数据类型用于保存具有指定查准率和小数位数的精确十进制数。

```sql
price NUMERIC(10, 2)
```

- **`TEXT` 数据类型**：此数据类型用于保存可变长度且无特定长度限制的字符字串。

```sql
column_name TEXT
```

- **`INTEGER` 数据类型**：此数据类型用于保存没有小数位的整数。

```sql
units_sold INTEGER
```

- **`SMALLINT` 和 `BIGINT` 数据类型**：它们是具有较小和较大范围的 INTEGER 变体。

- **`SERIAL` 数据类型**：此数据类型用于在 PostgreSQL 中创建自动递增的整数列。

```sql
id SERIAL
```

- **`AUTO_INCREMENT` 属性**：此属性用于 MySQL 中创建自增整数列。

```sql
id INT AUTO_INCREMENT
```

- **`VARCHAR` 数据类型**：此数据类型用于保存具有指定最大长度的可变长度字符字串。

```sql
name VARCHAR(50)
```

- **`DATE` 数据类型**：此数据类型用于保存日期值（年、月、日）。

```sql
event_date DATE
```

- **`TIME` 数据类型**：此数据类型用于保存时间值（小时、分钟、秒）。

```sql
start_time TIME
```

- **`TIMESTAMP` 数据类型**：此数据类型用于保存日期和时间值，可选地包含时区信息。

```sql
event_timestamp TIMESTAMP
event_timestamp TIMESTAMP WITH TIME ZONE
```

- **`BOOLEAN` 数据类型**：此数据类型用于保存真/假值。

```sql
is_active BOOLEAN
```

## 数据库关系

- **关系类型**：这些是在关系数据库中表格之间可以相互关联的不同方式。
  - 一对一
  - 一对多
  - 多对一
  - 多对多
  - 自引用（递归的）

- **一对一关系**：这种关系类型意味着一个表格中的每条记录对应另一个表格中的唯一一条记录。

```md
One employee is assigned exactly one vehicle.
Tables: employees, vehicles
```

- **一对多关系**：这种关系类型意味着一个表格中的一条记录可以关联到另一个表格中的多条记录。

```md
One customer can have many orders.
Tables: customers → orders
```

- **通过连接表实现多对多关系**：这种关系类型是通过包含两个相关表的外键的连接表来实现的。

```sql
CREATE TABLE books_authors (
    author_id INT REFERENCES authors(id),
    book_id INT REFERENCES books(id)
);
```

- **自引用关系**：当一个表格引用它自身时，会产生这种关系类型，从而创建层次结构。

```md
An employee table where each employee may report to another employee.
```

## 高级的 SQL（连接）

- **`INNER JOIN` 语句**：此连接仅返回两个表格中具有匹配值的行。

```sql
SELECT *
FROM products
INNER JOIN sales ON products.product_id = sales.product_id;
```

- **`FULL OUTER JOIN` 语句**：此连接返回两个表格中的所有行，包括任一表格中未匹配的行。

```sql
SELECT *
FROM products
FULL OUTER JOIN sales ON products.product_id = sales.product_id;
```

- **`LEFT OUTER JOIN` 语句**：此连接返回左表中的所有行以及右表中匹配的行。

```sql
SELECT *
FROM products
LEFT JOIN sales ON products.product_id = sales.product_id;
```

- **`RIGHT OUTER JOIN` 语句**：此连接返回右表中的所有行以及左表中匹配的行。

```sql
SELECT *
FROM products
RIGHT JOIN sales ON products.product_id = sales.product_id;
```

- **`SELF JOIN` 语句**：此连接用于将表格与其自身连接，以比较同一表格中的行。

```sql
SELECT A.column_name, B.column_name
FROM table_name A
JOIN table_name B ON A.related_column = B.related_column;
```

- **`CROSS JOIN` 语句**：此连接返回两个表的笛卡尔积，将第一个表的每一行与第二个表的每一行组合。

```sql
SELECT *
FROM table1
CROSS JOIN table2;
```

## PostgreSQL 特定命令

- **`psql` 登录命令**：此命令用于使用特定用户名和数据库登录 PostgreSQL。

```bash
psql --username=freecodecamp --dbname=postgres
```

- **`\l` 命令**：此命令列出 PostgreSQL 实例中的所有数据库。

```sql
\l
```

- **`CREATE DATABASE` 和 `\c` 命令**：这些命令用于创建一个新建数据库并连接到它。

```sql
CREATE DATABASE database_name;
\c database_name
```

- **`\d` 命令**：此命令列出当前数据库中的所有表格。

```sql
\d
```

- **`\d table_name` 命令**：此命令显示特定表格的架构/结构。

```sql
\d table_name
```

- **`\q` 命令**：此命令用于退出 PostgreSQL 客户端。

```bash
\q
```

## 关系型与非关系型

- **非关系型（NoSQL）数据库**：保存非结构化或半结构化数据。不需要严格的模式，对不断变化的数据模型更具灵活性。
- **关系型与非关系型的选择**：取决于你的数据和应用需求的性质。
- **关系型与非关系型**：为结构化数据和一致性选择关系型；为灵活性和快速变化的数据选择 NoSQL。

## 流行的 RDBMS 系统

- **MySQL**：开源、可靠、广泛用于网页开发，由庞大的社区支持。
- **PostgreSQL**：开源的、高级的、可扩展的。支持自定义数据类型和服务器端编程。
- **SQLite**：轻量级、基于文件、无服务器。适合小型应用。
- **Microsoft SQL Server**：专有的企业级数据库。
- **Oracle 数据库**：以大规模性能和可扩展性著称的商业关系型数据库管理系统。

## 最佳实践

- **命名规范**：为表格和列名使用 `snake_case`（例如，`delivery_orders`）。

# --assignment--

复习 SQL 和 PostgreSQL 主题和概念。
