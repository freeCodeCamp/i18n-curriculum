---
id: 6724e18296fa40173cc2437c
title: 網頁效率檢視
challengeType: 31
dashedName: review-web-performance
---

# --description--

## 實際效率與感知效率之間的差異

- **感知效率**：這是使用者對網站效率的感受。這是他們在回應速度和可靠性方面對網站的評估。這是一種主觀的衡量方式，因此很難量化，但非常重要，因為使用者體驗決定網站的成敗。
- **真實效率**：這是網站的客觀且可衡量的效率。它是使用像是頁面載入時間、伺服端回應時間和呈現時間等指標來衡量。這些測量受到多種與網路及程式碼本身相關的因素影響。

## 提升感知效率的技巧

- **Lazy Loading**：此技術透過在背景載入非必要資源，盡可能減少初始載入時間。
- **最小化字型延遲**：如果你的網站有訂製字型，你也應該嘗試最小化字型載入延遲，因為這可能導致閃爍或在訂製字型載入時顯示替代字型。建議使用與訂製字型相似的替代字型，這樣如果發生此情況，變化會比較細微。
- **載入指示器的使用**：當使用者點擊元素後立即顯示長時間執行的處理程序的載入指示器，可以幫助使用者感受到與處理程序的連結與參與，讓等待時間感覺較短。

## 核心效率、性能概念

- **原始碼順序**：這是指 HTML 元素在文件中的結構方式。這決定了什麼先載入，並且會顯著影響效率和存取。

有關原始碼順序的一些最佳實踐包括：

- 將標題、導覽或主要文字等關鍵內容置於 HTML 結構的較高位置。
- 延緩非必要的腳本，例如用於分析或第三方小工具的腳本，以免它們阻礙呈現。
- 使用漸進式增強，以確保即使在樣式和腳本載入之前，核心體驗仍能運作。漸進式增強是一種建置網站和應用程式的方法，基於你應該先讓你的頁面能夠使用 HTML 運作的理念。

這裡是一個良好原始碼順序的範例，使用我們剛剛介紹的最佳實踐：

```html
<h1>Welcome to FastSite!</h1>
<p>Critical information loads first.</p>
<script src="slow-script.js" defer></script>
```

- **關鍵呈現路徑**：這是瀏覽器將程式碼轉換成螢幕上像素所遵循的步驟序列。
- **延遲**：這是請求在瀏覽器和伺服器之間傳輸所需的時間。換句話說，延遲高代表頁面載入緩慢。

減少延遲的一些方法包括：

- 使用 CDN，或內容傳遞網路，從較近的位置提供檔案。
- 啟用壓縮，例如使用 Gzip，以減少檔案大小。
- 優化影像並使用延遲載入。

```html
<img src="placeholder.jpg" data-src="real-image.jpg" loading="lazy">
```

## 改善 INP

- **定義**：INP（Interaction to Next Paint）透過測量使用者交談（例如點擊或按鍵）到瀏覽器下一次更新顯示的時間，評估頁面的整體回應速度。較低的 INP 表示頁面回應更迅速。

以下是改善 INP 的一些方法：

- 透過拆分冗長的 JavaScript 任務來減少主執行緒工作量。
- 為非關鍵腳本使用 `requestIdleCallback()`。這將將函式（程式）加入佇列，以便在瀏覽器閒置期間被呼叫。
- 延緩或延遲載入先前涵蓋的龐大資產。
- 最佳化事件處理常式。如果這些處理常式執行過於頻繁或執行繁重的操作，可能會使頁面變慢並增加 INP。這個解法是使用防彈跳（debouncing）。防彈跳確保函式只會在使用者停止輸入後經過短暫延遲才執行－例如 300 毫秒。這可以避免不必要的計算並提升效率。

## 瀏覽器中呈現的運作方式

- **呈現的運作方式**：瀏覽器首先解析 HTML 並建置 DOM。接著，瀏覽器處理 CSS，構築 CSS 物件模型（CSSOM）。這是另一個樹狀結構，用以決定元素應該如何被樣式化。最後，瀏覽器將像素繪製到螢幕上，根據計算出的樣式和版面配置呈現每個元素。在複雜的頁面中，這可能涉及多個圖層，這些圖層會被合成在一起以形成最終的視覺輸出。

## 效率、性能如何影響永續性

- **背景資訊**：網際網路約佔全球碳排放量的 2％——這與航空業相同！每個傳輸的位元組都需要電力，從資料中心到使用者裝置。較大的檔案和低效的腳本意味著更多的電力消耗。高效率的網站不僅更快，還能減少不必要的處理程序和能源使用。

## 減少頁面載入時間的方法

- **最佳化媒體資產**：大型影像和影片是造成載入速度緩慢的常見原因。透過最佳化這些資產，你可以大幅提升網站速度。這包括壓縮影像、使用像是 WebP 這類現代格式，以及對資產使用延遲載入。
- **利用瀏覽器快取**：快取允許瀏覽器將你網站的零件區域的儲存，減少回訪者的載入時間。
- **縮小與壓縮檔案**：減少你的檔案大小可以加快下載速度。這包括減少傳輸檔案的大小以及縮小 CSS 和 JavaScript 檔案。

## 改善「可用時間」

- **定義**：「time to usable」是指從使用者請求頁面到他們能有意義地互動之間的時間間隔。為了改善「time to usable」，你可以延遲載入你的資源或最小化阻礙算繪的資源。

## 衡量效率的關鍵指標

- **First Contentful Paint 或 FCP**：它衡量第一個內容—文字或影像—在螢幕上出現的速度。良好的 FCP 被視為在 1.8 秒以下，差的 FCP 則超過 3 秒。你可以使用 Chrome DevTools 並檢查效率標籤來查看你的 FCP。
- **總阻塞時間**：這顯示主執行緒被大量 JavaScript 任務阻塞的時間長度。如果總阻塞時間（TBT）很高，使用者會感受到互動遲緩。為了改善 TBT，請將長任務拆分並延緩非必要的腳本。
- **跳出率**：這是沒有互動就離開的訪客百分比。如果你的網站跳出率很高，可能是因為你的頁面太慢。
- **獨立使用者**：此指標追蹤有多少個別訪客造訪你的網站。若要查看跳出率和獨立使用者，你可以使用 Google Analytics。它將允許你監控這些指標並提升互動率。

## 常見的效率測量工具

- **Chrome DevTools**：Chrome DevTools 是 Google Chrome 內建的工具，讓你可以即時分析和偵錯效率。DevTools 會顯示載入時間、CPU 使用率和算繪延遲。它對於測量 First Contentful Paint（FCP）特別有用，FCP 是使用者看到第一個可見內容的速度。如果你的网站感覺緩慢，DevTools 將幫助你找出瓶頸。
- **Lighthouse**：這是一個自動化工具，用來檢查效率、SEO 和存取。
- **WebPageTest**：這個工具讓你測試你的網站從不同地點和裝置載入的情況。這個工具會詳細分解你網站的 Speed Index、Total Blocking Time 以及其他關鍵效率指標。如果你想知道真實使用者在全球範圍內如何體驗你的網站，WebPageTest 就是適合的工具。
- **PageSpeed Insights**：此工具會分析你的網站，並針對行動裝置和桌面裝置提出快速改進建議。它會告訴你是什麼因素拖慢你的網站，並提供具體建議，例如優化影像、移除阻礙呈現的腳本，以及減少伺服器回應時間。PageSpeed Insights 是檢查 Google 如何看待你網站效率的快速且簡單的方法。
- **真實使用者監控**：RUM 工具追蹤實際使用者行為，顯示真實訪客如何體驗你的網站。常見的 RUM 工具包括 Google Analytics，它追蹤頁面載入時間和跳出率，以及 New Relic 或 Datadog，它們監控即時效率問題。如果你想要來自實際使用者的資料，RUM 工具是必不可少的。

## 使用效率、性能 Web API

- **定義**：Performance Web APIs 讓開發者能直接在程式碼中追蹤網頁載入和回應的效率。這些 APIs 允許你測量頁面載入時間、追蹤呈現和互動延遲，以及分析 JavaScript 執行時間。
- **`performance.now()`**：此 API 提供高精度時間戳（以毫秒為單位），用來測量你網站不同零件載入所需的時間。

```js
const start = performance.now();  
// Run some code here  
const end = performance.now();  

console.log(`Execution time: ${end - start}ms`);
```

- **效率 Timing API**：此 API 提供從 DNS 查詢到 `DOMContentLoaded` 的每個頁面載入階段的詳細分析。

```js
const timing = performance.timing;  

const pageLoadTime = timing.loadEventEnd - timing.navigationStart;  
console.log(`Page load time: ${pageLoadTime}ms`);
```

- **`PerformanceObserver`**：此 API 監聽效能事件，例如版面配置移動、長時間任務和使用者互動。

```js
const observer = new PerformanceObserver((list) => {  
  list.getEntries().forEach((entry) => {  
    console.log(`Long task detected: ${entry.duration}ms`);  
  });  
});  

observer.observe({ type: "longtask", buffered: true });
```

## 提升 CSS 效率、性能的技術

- **CSS 動畫**：動畫化某些 CSS 屬性，例如尺寸、位置和佈局，會觸發一個稱為「reflow」的處理程序，在此期間瀏覽器會重新計算頁面上某些元素的位置和幾何形狀。這需要重新繪製，這在計算上相當昂貴。因此，建議盡可能減少 CSS 動畫的數量，或至少為使用者提供一個選項，可切換開啟或關閉它們。

## 提升 JavaScript 效率、性能的技巧

- **程式碼分割**：將你的 JavaScript 程式碼拆分成執行關鍵和非關鍵任務的模組也很有幫助。這樣，你就能盡快預先載入關鍵模組，並延緩非關鍵模組，以盡可能快速地呈現頁面。
- **DOM 操作**：請記住，DOM 操作是指透過與文件物件模型（DOM）互動，使用 JavaScript 動態變更頁面內容的處理程序。操作 DOM 是計算成本高昂的。透過減少你在 JavaScript 程式碼中進行的 DOM 操作量，將提升效率。

# --assignment--

檢視 Web 效率、性能 主題和概念。
